<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Examples</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Examples</h1>


<div id="TOC">
<ul>
<li><a href="#vonbertalanffyal">vonBertalanffyAL</a></li>
<li><a href="#powerlw">powerLW</a></li>
<li><a href="#rampogive">rampOgive</a></li>
<li><a href="#trapz">trapz</a></li>
<li><a href="#meantrapz">meanTrapz</a></li>
<li><a href="#project">project</a></li>
<li><a href="#projectc">projectC</a></li>
<li><a href="#advance">advance</a></li>
<li><a href="#projectmf">projectMF</a></li>
<li><a href="#projectcmf">projectCMF</a></li>
<li><a href="#rescaleprojection">rescaleProjection</a></li>
<li><a href="#agestructured">ageStructureD</a></li>
<li><a href="#agestructures">ageStructureS</a></li>
<li><a href="#stock-summary">Stock Summary</a></li>
<li><a href="#spawningb0d">spawningB0D</a></li>
<li><a href="#spawningb0s">spawningB0S</a></li>
<li><a href="#prrecruits">prRecruits</a></li>
<li><a href="#prrecruitsgym">prRecruitsGYM</a></li>
<li><a href="#prbootstrap">prBootstrap</a></li>
<li><a href="#resamplergym">resampleRGYM</a></li>
<li><a href="#surveysurvival">surveySurvival</a></li>
<li><a href="#surveyadjustgym">surveyAdjustGYM</a></li>
</ul>
</div>

<p>This document collates and annotates the examples from Grym.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Grym)</span></code></pre></div>
<div id="vonbertalanffyal" class="section level2">
<h2>vonBertalanffyAL</h2>
<p>The GYM uses the von Bertalanffy growth curve <span class="math display">\[
L = L_{\infty} \left ( 1 - e^{-K (A-t_{0})} \right )
\]</span> to map ages to lengths.</p>
<p>The <code>vonBertalanffyAL</code> function implments the von Bertalanffy growth curve as parameterized in the GYM</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert age to length</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>age, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>len</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">309.8225</span> <span class="fl">384.6515</span> <span class="fl">430.0376</span> <span class="fl">457.5657</span> <span class="fl">474.2623</span> <span class="fl">484.3893</span> <span class="fl">490.5316</span></span></code></pre></div>
<p>and <code>vonBertalanffyLA</code> is the inverse mapping</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert length to age</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyLA</span>(<span class="at">L=</span>len, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>age</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span></span></code></pre></div>
<div id="length-at-age" class="section level4">
<h4>Length at age</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create a matrix of the age at each time step of each age class</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span></code></pre></div>
<p>Use a von Bertalanffy length at age relationship to create a matrix of the length at each time step of each age class</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ls, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length&quot;</span>, <span class="at">main=</span><span class="st">&quot;Length at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The restricted model assumes that growth is restricted to some fraction of the year</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion - growth occurs in middle of the year</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyRAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>, <span class="at">f0=</span><span class="fl">0.3</span>, <span class="at">f1=</span><span class="fl">0.7</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ls, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length&quot;</span>, <span class="at">main=</span><span class="st">&quot;Length at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is possible for for the growth period to extend across the year boundary, but no growth occurs before <code>f0</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion - growth occurs across the year boundary</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyRAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>, <span class="at">f0=</span><span class="fl">0.8</span>, <span class="at">f1=</span><span class="fl">1.2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ls, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length&quot;</span>, <span class="at">main=</span><span class="st">&quot;Length at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="powerlw" class="section level2">
<h2>powerLW</h2>
<p>The GYM uses a simple power law model <span class="math display">\[
W = a L^b
\]</span> to map lengths to weights.</p>
<p>The <code>powerLW</code> function implements the power law model as parameterized in the GYM</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">450</span>, <span class="at">by=</span><span class="dv">50</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert length to weight</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>wgt <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>len, <span class="at">a=</span><span class="fl">9.0E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>wgt</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01509613</span> <span class="fl">0.03923396</span> <span class="fl">0.08230066</span> <span class="fl">0.15075963</span> <span class="fl">0.25150604</span> <span class="fl">0.39181556</span> <span class="fl">0.57930604</span></span></code></pre></div>
<p>and <code>powerWL</code> is the inverse mapping</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert weigth to length</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>len <span class="ot">&lt;-</span> <span class="fu">powerWL</span>(<span class="at">W=</span>wgt, <span class="at">a=</span><span class="fl">9.0E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>len</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">150</span> <span class="dv">200</span> <span class="dv">250</span> <span class="dv">300</span> <span class="dv">350</span> <span class="dv">400</span> <span class="dv">450</span></span></code></pre></div>
<div id="weight-at-age" class="section level4">
<h4>Weight at age</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create a matrix of the age at each time step of each age class</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span></code></pre></div>
<p>Use a von Bertalanffy length at age relationship to create a matrix of the length at each time step of each age class</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length conversion</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span></code></pre></div>
<p>and a power law weight-length relationship to create a matrix of the weight at each time step of each age class</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Length-weight conversion</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>ws, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Weight&quot;</span>,<span class="at">main=</span><span class="st">&quot;Weight at Age&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="rampogive" class="section level2">
<h2>rampOgive</h2>
<p>The GYM uses a simple ramp shaped ogive to model both maturity and fishing selectivity.</p>
<p>The <code>rampOgive</code> function implements a ramp ogive parameterized in terms of the mid-point and width of the ramp</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">150</span>, <span class="at">to=</span><span class="dv">450</span>, <span class="at">by=</span><span class="dv">10</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(x, <span class="at">x50=</span><span class="dv">300</span>, <span class="at">xrange=</span><span class="dv">80</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>x, <span class="at">y=</span>p, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="trapz" class="section level2">
<h2>trapz</h2>
<p>The <code>trapz</code> function implements the composite trapezoidal rule for numerical quadrature, and <code>ctrapz</code> implements a cumulative trapezoidal rule.</p>
<p>Consider the definite integral <span class="math display">\[
\int_{1}^{x} 2 x dx = x^2 - 1 
\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The definite integral of 2*x from 1 to x is x^2-1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ctrapz</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="dv">0</span>  <span class="dv">3</span>  <span class="dv">8</span> <span class="dv">15</span> <span class="dv">24</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">trapz</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x, <span class="at">h=</span><span class="dv">1</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">24</span></span></code></pre></div>
<p>For a matrix argument, these functions operate column by column</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Integrate cos(x),  sin(x)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">2</span><span class="sc">*</span>pi, <span class="at">by=</span>h)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cos</span>(x), <span class="fu">sin</span>(x))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>x, <span class="at">y=</span><span class="fu">ctrapz</span>(<span class="at">fs=</span>cs, <span class="at">h=</span>h), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="meantrapz" class="section level2">
<h2>meanTrapz</h2>
<p>The <code>meanTrapz</code> computes averages over a time interval, but if the interval consists of a single point the value at that point is returned.</p>
<p>Consider the expected value <span class="math display">\[
\frac{\int_{1}^{x} 2 x dx}{x-1} =
\begin{cases}
  x+1 &amp; x \neq 1\\
  0 &amp; x=1
\end{cases}
\]</span></p>
<p>For an interval <code>trapzMean</code> computes averages with the trapezoidal rule</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The average of 2*x from 1 to 5</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">trapzMeans</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">6</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">trapz</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x, <span class="at">h=</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">6</span></span></code></pre></div>
<p>But if the interval is a single point, the value of the function at that point is returned.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For a single point return the function value</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">trapzMeans</span>(<span class="at">fs=</span><span class="dv">2</span><span class="sc">*</span>x)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2</span></span></code></pre></div>
<p>For a matrix argument, these functions operate column by column</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Average of cos(x), sin(x) from 0 to 2 pi</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">2</span><span class="sc">*</span>pi, <span class="at">by=</span>h)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cos</span>(x), <span class="fu">sin</span>(x))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">trapzMeans</span>(<span class="at">fs=</span>cs)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">4.218847e-17</span> <span class="sc">-</span><span class="fl">1.241954e-18</span></span></code></pre></div>
</div>
<div id="project" class="section level2">
<h2>project</h2>
<p>The <code>project</code> function projects abundance, biomass and yield by age class forward over one year when natural and fishing mortalities are known.</p>
<div id="setup" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort, assuming fishing occurs on days 80 to 119, and define a length based selectivity</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral and the annual scaling.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="projection-from-equilibrium" class="section level4">
<h4>Projection from equilibrium</h4>
<p>Project forward one year from an equilibrium age structure.</p>
<p>Compute an intial age structure assuming constant mortalities and assuming no plus class</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Examine the final abundance and total yield</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Final abundance</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>N[nsteps<span class="sc">+</span><span class="dv">1</span>,]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span> <span class="fl">0.1794040</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Total annual yield</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2811238</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance, biomass and yield by age class</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>N0, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="projection-from-survey" class="section level4">
<h4>Projection from survey</h4>
<p>Project forward one year, matching given average relative abundance and total biomass over a set of reference time steps obtained from a survey</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection given relative abundance and total</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">## biomass estimated from a five day mid-year survey (days 150 to 154)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>Nsurvey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">0.67</span>,<span class="fl">0.46</span>,<span class="fl">0.33</span>,<span class="fl">0.25</span>,<span class="fl">0.18</span>,<span class="fl">0.13</span>) </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>Bsurvey <span class="ot">&lt;-</span> <span class="dv">15000</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>Nsurvey, </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">nref=</span><span class="dv">151</span><span class="sc">:</span><span class="dv">155</span>, <span class="at">Bref=</span>Bsurvey, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Examine the total annual yield</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Total annual yield</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1954.908</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance, biomass and yield by age class</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>],<span class="at">l=</span><span class="dv">65</span>,<span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>pr<span class="sc">$</span>N[<span class="dv">1</span>,], <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span> ,<span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAk1BMVEUAAAAAADoAAGYAOjoAOpAAZmYAZpAAZrYAtusAwJQ6AAA6ADo6AGY6OgA6OpA6ZmY6kLY6kNtTtABmAABmADpmAGZmOpBmZmZmkJBmtv+QOgCQOjqQOmaQ29uQ2/+liv+2ZgC2kDq225C2/9u2///EmgDbkDrbtrbb25Db///4dm37Ydf/tmb/25D//7b//9v///+eBlV8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAZuklEQVR4nO2da2PbuLGGla1Pk3j3tLWd9NTe1lHbjbpOZZv//9cdgheJlHDlzAAD8n0+7Co2RUCjh8AML/CuAYDArnQHQN1AIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAm6QLuqYQjhtuPDIBB5DwXJIZB8E3LkEyjHsSwAV6/3/fF6J9hEEdgECgVoV2mgmDq9v3np//9RrIkycAkUCtAoUXXw9Pnty3P/4vWX34SaKASTQMEAQaD+hUegH1NYWs1BLoE2P4UNI/M4Ugea+FGNTWxTWDBAG0+iD4QkWrNObEk0JUCa0VfG69IJ54ECaC/jS+uUrYyvlbrK+Pw65Srjq6XiMv5HDp2yVWG1UrFAF8joBIEClCnj5eEanvKV8ZWioYzPwGKfUMYH0FfGZyBBJ5TxAbSX8Rn44fMJZXyAusr4HMw9QhkfQLAKi7+pTzGSVdhGAhTDlqtUlPEcbLhKRRnPwnarVJTxK2hCDpTxAVDG+0EZHwBlvB+U8QFQhflBFRYAAvmBQAFQxvtBGR8AZbwflPEBUMb7QRkfAAL5gUABIJCfBIHen3Y3v1tyZIY2FBPfeV983h7GC8s/ba7IGLd4f7o73rwcLElys+0ADXjjYz9BltqERuIFaiv1NkC2Mr1juwEaCMSn9YvchEZSRyBbmT7+enkbikkcgZzx4WhCI2k50G63ID5rD9AI4rN0C/k9FARVmB8IFAAC+UkQ6PXn5+ZgKbIY2lBMfOcRH/8W70+P7X+dZSqpDcUkJNGIj3eL/oK7s0wltaGYlDK+SYvPRp5aOW3RnelBmeoE8QlskVymbuQIG0EZv3QL+T0UBFWYHwgUAAL5SRDo6LpYSm9D8RrA8R2TjI9eEqqwh0fJNrRGMb4Ko8bn+/eF7y9Kahkv0sYuridFSCzjSU18t7Bwn9lImMIO7hs2iG2sQiCh+Nik0mRVyhQmN8evYwrLlgNZpSpklZIqbA1JdOEmChmlRCC9cHU+/9oBeWRKyYFQpnrxxqfw2gFyJiWV8eaWTdeNq5tfncMbHz2PfnNPc0ll/NvX31xXm7E6hzc+egS6wJ6PJ3iVdD/Q+6/PtQWITMr9QO74VLZ2QIJWaXckHu1zFAQy+OKzirUDrDpxVWF1HWEJVFPGF4KtjF/BEWal3jI+D5ECeR9dprehmLjOB+Oz4SJjfi0MZbwTX3y2nCPG3VS/4SNswBsfCGTKVM9N41sO0IA3PlsuMuY31TtuWYBA/vhsuchAGS+26208tYIynoXtFhnLb6rfyBE24o3PhouMyJvqBY+wogby3FQfkyPejyT1rzRcN9ULHmFl73fluak+pci4dxPbl4ww3VQvWIUVvuOe6aZ6liJDo0hMN9VDoNBN9ZxFhiaJKijjK5nCMjehZSiqoYyvI4n28/Zw17ze2k80Lm9CgURMUxixDcXwTGFmEeRudrclSsT4lLUodQTaO2pVmSNMAYmdd8TH5IidO0KXespNaKkCOa42Sx5hZUnsvCs+vz43R0GBOopIlCrQ0V2FSR5h5UjsvCM+zfHDs1mF07qeP2t8cluUnAPZh+gsR1gRUnMg1+no/tcfbCcb+eOT0SKuKizbEZYbrWV8mDwWsZXxWY+wjNQrUId4ds10QxmxDcVw3VDG0sRCJC1iuqWV2IZimG5pZWmChJBFXDfV09pQDM9N9TxNMMB+PZbtsR5SG4rheayHqQk+PPeMpDkWKRAeLPSzxvjE+cVWhYnuoSCVV2HiJAp0XNERFkda5ynx+WwleW+ZSRJo7169hNYGAel7PVJ2nxifmIcO1EuVUsYvmuCj2liO+N1mCWV8tvho0ihWoNfb3c3L21dtAsnf7xq58wLx0TEcxVZh3UkOCOSiXHxKaxQ7ArUDdPIRluPBQi1T2JL4JDbhpZhHCUn0XmMOpCiJVhCfAll2UhXmWUOS1oZiUjqvJT45NUo8D/R6i/NAPlTFJ8t4hDPRAeo/Ey3rEQQKUL9AA0KnISFQAK7Oh1cv+fTpE1NbXuxXTBaf6oZAAZg6H7V6yac4eHrkI0ayzxedd1K1QPQin6fzrItP5BMpgnULxHCaUaFAIypEWrVAHBc6uKYwwUVIM85t17AJpHERSUUCZVmEtIRJXALpXERSzRSWuYmMJjEJpHWhcS1JdKkRWr50W7lAdHKW8YKInQVgm8KwUr0PTQdY5NmmyHNPbEk0Vqr3oUmgRTidWnUZz0G+Mv5bAjyd4mDVZXyAqAxbZRmvyKV1l/Fe4mp8yRu6WW75LSzTdquwyLOMVZXxBaY5CBSzGZ38I3SmpGnDZXzOKaz0ASaXhG+5jM+YRJcW6JKUis9fCUqO4Rv7g3NeIkbo/6bA0ysGtlzGR6GyjL+Sjdy9xWy4jPczjpt1XI0vN0Rttwrzc8qwmTpv1u4wo0+u+GSb9SCQld38P3TMyGxG6XLxSUqx4nOvDZfxPrgF6g+w40+/VX6AXbu05TLeB/MUNozQx5vf6xboGlyNd8CcRA8j9MG2gEeV8RnhEih3kpgNtiR6MAgC2fEmiVWTHNJkSn9CGuGPFxMDb5IYsyOhX4rtVwCeC3OaNknY0JskxuwIAqn66rML5E0SY3YEgVR99fkF8iWJMTuCQKq++vwCUXcEgVR99RBIer8CaPrqIZD0fgXQ9NVDIOn9CqDpq1cpENgmEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABI9Ar7e73aPrl8fd7sOz573uuxzNbi1Pog2Md/o72ty5f9vu19cjVtpejjdRTV66NnEFcvZWe8TmDVk/+7whRwhOe3d1dw6LQG8Pj83R9ZW8/vxsbqd2vnnv/t3R8ij+5I03L2bfTpyNmu56bo3jZf/x/FjmR+viApOfOwM5e6s9YtOGHJGZN2QPwdvD+GNXd+ewCHRsh4n3J+cQNHk22vLeP7hHoL3vj9x69tn//sHVIXOMhd7NhWlnOKYnL12buAI5e6s9YhcNBfriDMFh9+dh767uXsCWA7m/L9Mt50T0/vd/OTv5/qvvSw59OE+b7Vd0dE+NrEy+KdeXdvFzWyCnmzgidtFQoC/OEPznZXx35GHGJpD7+2rnW3fGcbhzi/D25X89ucrx5p+exMs7IrazeyZ/FghkC+R0E0fEJpu4IjPT0BmCQgL5cwp3OvLXF7dAZh5/++r67bHNE52Jl3eAenu4y5YDJQtk7dhkE1fEpgI5IjPdizsEZQQ6+KsaZ0f2j4GpyP0RAonXwZ3/5cyBUgWyB3KyiStisxHIHpmIvjSFBAodz8607qErtxel3+YDegTyJOB6k2hXIM+bOCN2kSEHUvEIgXIm0cFq+vVP7pTD3cnAO1tF3KcH/ClQviksrYx3BnL2VnvEpg05InPexBOC094zlvF77zhy2HlPSHks97/TnC5zWuIdYXKeSGyHDPMZzIA4vPRs4gzkZC+uiE02cUVmskngRKKvu3NwKQOQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEgoFcjzzDIwiwi5Fz/KjE6B3p/+L/xI22bpntwyT7drQKdAr7+4F30B/YOFvkW7MqJToMPH/iHMdrD+49Nj5DOSm2F4Sv7Lc7eS3/AAsmcxCVFUCtTF5ualX4ht92iec/csP7Q5eoHaqAwr4gWWmZBFpUCjPMP/c66mUQMngcw/2sCYVxHraMigUSCzNkA3Nh/6hW66qgNl2YnzFGYi0wamnb4OpVJqjQL1AXr9+XkyAoEzpyS6W8Lti1nG7d/e5SQl0SjQsCrN/m6SA0GiM6cy3hRiezM07//mWYBJFoUCjemOOcRud/9jjrAHzGAT+hOJj/1c/xeTCh19i7zJolCgOcieIyg4PqsWKLTIPRgodRKoUS6QWeMOc1eQ19uCB5lugYB6IBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgQRdoVzUMIdx2fBgEIu+hIDkEkm9CDggUAAL5gUABIJAfSYHip0nFQCA/GIHs/Pjxo3+xQoHueYjt/AYFOtnTrFGge9a9QaBLfkz1gUAhINCMC3uaFQrE6w8EmnJlTwOBQkCgkevBp2NtAjH7A4EG7PY0qxOI2x8IZLi253tL/woC+WETaN+fM7xbvodSzO353nP697oEYveHTaD9zUv//49L91CG8+Bzac6AYOfzn6nn94dLoLcvz/2L119+W7aHEgz2ONTpWdUIBIEYMVWXz5yBNQkk4A/fFDZMXeNUlr6HvESo07Mige41C9Qcakmio9XpWZNAEjvdUhk/5DrOUz5W1iOQiD9bKeNPw06aPc2KBBKZwDZQxs9mrGR91iSQzG7XXIVdZDsL7GnWI9DEn888xHa+SoGuM+Vl+qxRoPGr52FVZfz3Exe/WGpPsxqBpgMQ647XUMa7tBkh6LMWgWYTGOueq34qIyBOB8mehu/bLVulig1AtZbxsWcDqfqwdb5wlTrJgJj3XF8Zn3Amma4PV+cLFxly/qirwvynu1KuQnDY06xDIKkKzKBEoMnjaudn1makXcHi0odvCitZpZ7iye9P4TL+8jHHyY+n/06Uh8+ehu/bLVilCk5gpcp4uzeXW3QvEt1pLm9RpVJ/GX+OsoA/ma/GB72ZYbZMlId18Omov4wX9YdNoLeH3c3vt7udpQgb9xAtjmGYteJt62DXZwVlvGQC1DDmQHftJNYG58AQoItZK9ohfnsa0Sosz031sgMQZxXWBYlaptpTnoiBSGDw6ai9jBf2R5NAgVrLK5GUPtWX8dL+sJfxS6ewqGLL5ZCcPtWX8WO8ZBKgJkmg40+/HXYfnu1bvT91obEdYME2Uir1a4ck7WlqL+OtA9AnHmI7P27x/vT49vB4tBkSuQcLqacIO6YSCevD/O0erNGTE+gUp5k/rE3EC9SmOO0YZMtxlraxRJ6B/mySuD0NWxL9MFZcP+VMom0D0KdSArUjUHsA2Y+h9DYI8owkniNaCNO3+3prpvjMI1AGf5JyoDYBev3ZkQOltMEgzzB3ZXCI7ds9tGNPIYEE/cn+YCGLPLNzhsIS8X27bw8f8wpkqcDY/ckq0KKM2cJV6iPiUPQ6yPEcdzkFskxg/P6wlfERe2CRx1l3LZUosI52xWX89QQm4E/pMj4Vb90VcsjniZPqBZomQAKtlCzjO1xPPNqIKNvPTqS7YqVagUZ/JgOQRDOSZfzF1WbvE7ITXA7FnvWh6HJNrQJZJjCJZoqU8WEsDuU4aWgj+nYo94lCniYSuZrAZPzJXsZHMxucStnTpHS+u468t10tZWsinlz+6BWoOTtUUJ+Ezve3/LDniAvpBTofg1L+pAh0KDBEG4cK2tMkdP79qRuBylapI5cDkJg/KVVYV8PnHqLb0cdbmIkT3/n3p539nnC+JmLJNoEllvFvX/nLeB+nuaugQ1VWYcMEdvq3nD9pZfz7r88ZBZqnPv4zRHLUKFC2BKhJyoHaEv5ovyeT3IYFS+JcxCHBMl7qqYz7iwFI0h+tVZir7srvUIUj0MUAdOXPNx5iOx/58RifvAyU7Xklqk+giwz62h/W1pLORHuGaL4nL2PO+mR0KKkKu/l9QYooI9DJn0uBvpUSqC3j3RuxPTgXf9Iwk0MJ54Hujny3/C5nPoFd+8PaWGIZ796IR6DUU845BqKUM9GtQMXPRM8z6Et/mIefJu1MtO8kGcOTl4uuWARuAKGTOAIVPxOd2R+2HIj85CXhgpeoQ4lnohf4wyrQRQI0/6WAP1w5ELEN8vVSOYcqq8I6gU4J0Px3Avqw5UAxZXzSE7MLkJGoLoHmE9j8dyL+JE1h3hxocRl/OfhQJBLIiCLPRH95Hk5Gl72hrB+A+tfzKEpMX4aUKcwToMVVmHXuIg9ELIQ7zwRfE1N/5gJJ+cN1JnqhQO7Uh+QQJ1zfbpY1Ep0DkJg/bJcylpTxocxZhUSRU9jXwMyVZY3EAv6kCOQvU5PL+Ki6i5ZWcxB9KdBbwOdZ4s4IlNmfpPuBUm/Z9NyukFK2l3Uo+ts9+BTKIlDnTy/Q3B+m/VtJLeOdp+pT5vjksz4FHUo8kei82Cy/RuJkAptFS9QfthEoYY5feM6wkESx3665Fu8bnOXXSDxPYNNAXU9f/2UitvNROVD8EE0651zAobhvN6QPQxMhzgNQyB+W5kbylvEMT3jlHoiYqjD5Mn4yAJ1/KO5P1jKe7QHBnBIxzS/iZfw5g/b5w61PtEDhU/XhOZ71+dJsDvEIJP6nDu5PA9DUn4uN+PVRe1N9FFkkEhSIs4lS/rAJZDJsM/rk/lsQ4hJxTWGyZfzZn3M0LvwR0SdeoHYC+/CPJ/eZaBMgE5wSfxNUVCKuzsuW8aNATn+E9IkXaH/XvN5+tCeBzThEO1Ywy3BBW+6SRxVX4y0TWCZ/EpJo82yz80z0MMcfrc+1ZPgODDISMXVedIo3GfR8AvuWyx8ugcaR6ZB3Kf8r+CVizIHEpvj7oYJ3+COoD59A/YWOfj329DZYSfxzMwE4qzChKf4qAZr5I6oPn0C0NsoQ5RdrGS8zxd9fJEA5/YkWSN0ikrngLeMlpvjTBDb8e+qPtD5ZTyReLexQBWxJtNgUPwxAJ38mv5L3p9CZ6Jh1Q5SgvoxvSzCHPxn0UXkpQ5dE+gXqJrAxZcvtj0aBDHok0i5QP4EV80erQAYdEukXaDKBncOVSR/VAnUUl0i5QMMA1P/jFKls+ugXyFB0KFIvUFl/RAXivGGqmES6Beoy6CEBGsOTU586RqATJSRSLVBXwvf+fCvjT10CGXIPRboFOk1gY0wy61OhQB0ZLdIs0HkCK+ZPpQIZMkkkKBA5RzxNYOX8qVigDnmLFI9ApwlsCEEBfaoXqEPUIs0CmQmsKevPKgQyiF2G1StQN4E1hf1ZjUAdEhapFWhMgPoPXEiflQnUwXyniF6BPn9W4A+fQFnWACTjvxHJJptWgYYJrOtmOX34BMqyBmAJ1Aqkwx8ugWKe/Q6uVaQSpQKZCWz0h7s/SWQUyI1modQK1CZAxp/SwWKbwjgXD9BkkU6BKP58ZyK285Efj33xACWDkU6BzAS22J/05jxoL+OLW6RSoPven/L6VFLGlxyMdAq00J/v7P7UVMaXsUijQO0ApEQfJVVYCrlHI40CLfJHRJ8KBerJZ5FCge4/ffuW+OGF7GmUlvGx5BiNFApk/El6g5w+msv4aGQ10ifQ57Th57ukPvU81hNESiN1At2n+CNsT1NJGZ8A+5U2rs6zxSfaH3l5DBWV8UvxXMSNuLjL1Hm2+AT1ubjUIE2lVZgwE4t4Oh/zpw4i5Q5eo/qRidj4bFGgCYIC8TZRiKrL+BxwTWHbjY/6Ml4Wrs5vNz4MV+Orhvzxtx4ftghG7KiyTXjR9Mk44wOBMqHpk2UXKGYhck0fDQLl2CRpQ8ffgUrbUWWb8KLpkxUQ6P3JVmAk7qiyTXjR9MmQA2XZhBdNnwwCZdmEF02fDAJl2YQXTZ9MpUBgm0AgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARJkgd6fTneZTV66Nnm93e0e/ZvYH465bMh6//q8oQ/P1g6f9u7qLi9rjw9ZoP3H80MtH+03np1//vbw2BxtHZ+9dW/t97Shm5fXn717MQ0drLt5exh/7OouL2uPD1Ug80zd4OzkpWuT481LK/b1ITZ76/EPtiPsoqFAX8z/rJsddn8e9u7qLi+rjw9VoElPXJ26+LmR37fJ+9//Zev2RUOBvphv4Wh5yq/5z8v4bmcMWVl9fPILdLD0e7rJ4c4agMkmx5t/WjOFWZifdrb4NOfwahWosvhkF8g68042efvrSzBAbYZoyxSme3m4c8zx2gWqLT65BTpYc//JJvtH+xA8O8LsmUJEXxrtAlUXn7xJtMv68ybDI2jePNL8L5BqRgRIYxJdYXzylvHW4vLqrfZuTxtqh2hbpM+bmMeQAkO0xjK+wviQBWoPCdORts/jS88me8fhM92LK0CTTcyJMtvptskmgRNlvu7ysvb44FIGIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQ0CiQWSTHvsANMKiKj0qBzJNJ5ultYEVVfNQKZH+2EjTK4qNXIPNs9rEdqocHbA/yTyHXgqr46BXo/elxWPHNtVjAVlEVH9UCmX+0B5p5Jb+ORj2oio9egbrlRdp648OzGZ4POlJGFaiKj16B2iTRrHZi4vT29d+/Sq8EVRGq4qNWIFOmmkJjb1Yh2f/tT/YF/TaJqvioFOh2WCXHrHPzFzPVH63L3WwVVfHRKNA1SKH9FIxPHQLhJJCfgvGpQaDXWx0nXbVSND41CAQUA4EACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAg8f9h3htffZTCrwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="multi-year-projection" class="section level4">
<h4>Multi-year projection</h4>
<p>Project forward 10 years from a virgin stock assuming constant fishing mortality, collating annual abundance, biomass and yield.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(Years), <span class="at">ncol=</span> <span class="fu">length</span>(Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural mortality and no fishing, assuming no plus class and 8000 recruits per year.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and 8000</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming constant fishing mortality, update the the initial abundance for the next projection assuming 8000 new recruits, and record the final abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant fishing mortality</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age class</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="projectc" class="section level2">
<h2>projectC</h2>
<p>The <code>projectC</code> function projects abundance, biomass and yield by age class forward over one year when natural mortality and total annual yield are known.</p>
<div id="setup-1" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort, assuming fishing occurs on days 80 to 119, and define a length based selectivity</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral and the annual scaling.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="projection-from-equilibrium-1" class="section level4">
<h4>Projection from equilibrium</h4>
<p>Project forward one year from an equilibrium age structure.</p>
<p>Compute an intial age structure assuming constant mortalities and assuming no plus class</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year, selecting the annual scaling of fishing mortality to reproduce the known catch</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="fl">0.2811238</span>, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>This determines the fishing mortality required to reproduce the target yield</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fishing mortality and total annual yield</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>F</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2811238</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance, biomass and yield by age class</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>N0, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAk1BMVEUAAAAAADoAAGYAOjoAOpAAZmYAZpAAZrYAtusAwJQ6AAA6ADo6AGY6OgA6OpA6ZmY6kLY6kNtTtABmAABmADpmAGZmOpBmZmZmkJBmtv+QOgCQOjqQOmaQ29uQ2/+liv+2ZgC2kDq225C2/9u2///EmgDbkDrbtrbb25Db///4dm37Ydf/tmb/25D//7b//9v///+eBlV8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAaq0lEQVR4nO2da2PbuLGGldSn3nj3tLWd9NTe1lG7sbr2SjL//687BKkLKeHKmQEG5Pt8iBWbIqDRI2AAgtCqAYDAqnQFQN1AIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECARKRA61XHvWxl6mW58YkTaH3z1v+8laxLvSw4PlEC7b++9A92v/yQrEytLDk+dIFWVcMSxCXHJ7ILOzTNx6Y6/QxKYar8guMT+fI2vY+2JLE/A9NnOTdctQ7Gp1LYBAqdYVVpoDJUusq4HMkl0FGi6oBAfrgFGiaJwzwLAvW44tPyPoC3UEnQhQUo0gK91yNTNoGWnkRPL0K3TfkEqpTyAg15V2cTBAqgS6ARKmRiEmj/eEwIP1tmWtOrpQemmWjx+JSyia0F8lwlhEBN5vhktIlNoI9n50oFCNSUjI+sTciBAijOgabAnoVDoAAzE2gEh00QKMCcBRox0SYlAumdZVyMQCPibdIhkOLrHMsUaIxPJxUCab7Smk+g1x758oiMRYJAAXK3QK9j5EsnokIgdGEu9NukQyAk0VFo1EmJQHrRJNAYHZ0dBAqgV6AxpWyCQAFqEWhERpMgUIAqBTohLxIEClC3QEfkNOISaP+4+vzb82plW/UCgYoXcUBAIy6B1k/NdvXUNBuLQRCoeBFDeNNtriWtX1/6DQSsmwekV0sP8xNoxMVcQLpPnAJ9+wGBlBYRTbJP6MICLEygC8INVIJAH8+rm99d+yNJJtFFr3PEl+2NT0QRDy3pT86KRaZ4gT6e77c3bxvL/jaxZ5hI2Sut0UWnx+d6j6aHC9KqWoR4gdo0pw3QlC3aaG9/4bUe0SVLxKcCoVJbINsOW0M8u09MpBaB4uJDKkKjRmk50Go1IT4L6cKyxUeXQjVcyqgkic5YhCKH2ARaL3YPwCJFqFEoQaDdzy/NxrI3QIdvI+2FCOSND08RI3Q4lJJEP7X/Ooap/n2Qp1ZOAwlJtCc+PEVcocChpGF849xpHQL548NThIXio7KELqzrnVzD1AVvpH3EGx+eIqyUVYhtGL/cjbSPlJrmKNsM1TCML4rSUdglxRyCQAEqEagp5VCCQFvXHn/0MhQTX3kF8SmgUMIo7PFJrAzFxI/CdMQnt0Opw3iZMhSTOIwXLSKSrA4ldGG2xYZMZSgmvvKa4pPPoZQurHwfX4CELkxXfDI5hFFYgHpGYVdkGZZBoAAVC9TkcCglB9LVRGciIQfyxWf/eN/s7krcuSvsUNIw3izZdO63TilDMSnDeHd8zD713XXWIrc9STqUNIzff/uRf1F9YVKG8e74mDF+506p1QpiDiWtB/r49QUCufDGp/1Lsy0pUCPlUNqKxK39cju5DMUkrUh0x2f76cWsOLN+5UrG+PA7xDUKK5ckCsNV+X6a6JNttjpvfJhvDWISqGySKEndw3gnl7csTpYqUiDvN+41CpJEMWIbYH98GIqQxyZV0KrUa2GuYaqCJFGGxGthoWkO/jt3ZQlKxbSoXkuSyE++RfVfLkg+TzaGGqUM472LxkslidKf34RhPPOi+kuhdFqVuqh+ypIFybd4Jd3AJS6qd8aH6c5ddRZVfjF1JXx+tpOz3rmrySFugTInibUIxH7jpZqGqPZF9Yq6MF98JO7c1dGbVb+oXk0S7Y+P0J275R1iW1S/+O1dAvGRu3O3rERci+qxvUvJRfUFezOmRfXYnaP4ovpCDjGNwiCQiiIKSMQ1jMf2LkqKyN2bMXVh2N6leBc2IKdEqS3QesJYfhkC9eiJTyaJUgXCmmg/quKToyVKFWiroYnOSWLl1cVHWqLkHEhNE52J1BxIZXwEJar8arw8tY3CXEi1RBAowFwE6hCwqPYFZeJwLShjKYID5iWObEtaSWUoptyS1jxYF84myMW1qJ5WhmLyLapXh8+tk1xMt/XEnaFGmG/r8RTxk5v0c0pzUihSoFncODeJuMrLxkezTxiFBVA4ClMlUaJA28paIPqC17QTZIuPmqYoSaB1aHcX+7dllROIYcl9yvOD8aEXMUKDRSnDeE8H780BignEcdNPwjA+NQFiuu2prEWxAu3uVjdv+2/OAO3uzGdPWQuUUaBQfBiK8FGuLYodhXWTHN4Ama8LVSZQvi4sIj7UIsIUsSi2BWob6NAnbP94q02gfEl0RHyoRcSR26KEJHod7OO39i/sW8gwPhwfchHR5LMoaRQ2bY/NpQikLj5ZGqPEeaDdXV3zQHTSKq8vPtKT19wz0bVt4RZE4Uz0BOQswqWMAPMQqEdCIwgUYE4C9fBe82cTaPG7c6guIgrPehK3ZlwCYXcOchHfvchXI45Lk5gEwuYKwkUo1QkCBVEi0BhFGrF1YdidI3sRKpojtiR68btzFCuirEZLHsZHzXDqF+hAIY8WLFDcWo9qBOrJ3q0tV6DI1WaVCXQkm0cQKOYwWQSLkG+QlivQPLswB3IiLVigrEm0WXJvRqhl58kEpreXLFAUTJU382RmjkzVRKv/4kncFRUIFICn8v1M/fbzD49Af8TBUp+pXLsEgQJwCtRsb34nt0A6TDoBgQIwdmGNma9nu/FSSZsEgQKwJdEHg/jv3C1rEgQKUNEwvohJEChARQKdyagSBHJwnCRirnzmu1bkR28QyM5pmrrKFsiClEoQyMpq/E+GwjISOeEUNxUFgazwCzSju1ZGGkEgO9xd2ILvWlmmQMxJ9JJvOlioQEcgkJ8sAlUN+eV3eO9aqZrw288TwcCJhP4odt5kPHetxBdY2SGJB5JONHuBwmh66yGQ9HkF0PTWQyDp8wqg6a2HQNLnFUDTWw+BpM8rgKa3HgJJn1cATW89BJI+rwCa3nqVAoFlAoEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESPAItLtbrZ5cf9yuVp9ePM+1LEQfnNb6Pa0dx33lHGV6Vpi25/XViJW2lsctOwYPXYe4Ajl6qj1i44Ksr31ckCMEp7O7qjuGRaD941Ozdb0lu59fzOZdziev3X/bWm6zGjzx5s2c24mzUFNd20YsIqxvz0vub603jg1+7wzk6Kn2iA0LckRmXJA9BPvH469d1R3DItC2bSY+np1N0OC+F8tz/+Rugda+L7n1nLP/+6OrQuYzFno2F6acw2d68NB1iCuQo6faI3ZRUKAuzhBsVn89nN1V3QvYciD3+2Wq5eyIPv75H2clP371vcmhF+cps32Ltu6ukZXBO+V60y5+bwvk8BBHxC4KCtTFGYL/vh2fHfkxYxPI/X61/a0749jcu0XYf/1fT66yvfm3J/Hytoht757JnwkC2QI5PMQRscEhrsiMNHSGoJBA/pzCnY78/c0tkOnH999cf922eaIz8fI2UPvH+2w5ULJA1ooNDnFFbCiQIzLDs7hDUEagjX9U46zI+inQFblfQiDx2rjzv5w5UKpA9kAODnFFbNQC2SMTUZemkEChz7MzrXvshtuT0m/zAj0CeRJwvUm0K5DnQ5wRu8iQA6l4hEA5k+jgaHr3F3fK4a5k4JmtIu7pAX8KlK8LSxvGOwM5eqo9YsOCHJE5H+IJwensGYfxa287sll5J6Q8lvufaabLnJZ4W5icE4ltk2Feg2kQDw89hzgDOTiLK2KDQ1yRGRwSmEj0VXcMLmUAEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJpQJ57lkGZhMh79dr5kSnQB/P/xe+pW2xdHdumbvbNaBToN0v7k1fQH9joW/TrozoFGhz29+E2TbWf35+irxHcjEc7pL/+tLt5He4AdmzmYQoKgXqYnPz1m/Etnoy97l7th9aHL1AbVQOO+IFtpmQRaVAR3kOP3PuplEDJ4HMf9rAmEcR+2jIoFEgszdA1zZv+o1uulEHhmUnzl2YiUwbmLb72pRKqTUK1Ado9/PLoAUCZ05JdLeF21ezjdtv3u0kJdEo0GFXmvX9IAeCRGdOw3gzEFubpnn9D88GTLIoFOiY7piP2N3qf8wn7BE92IB+IvGp7+v/ZlKhrW+TN1kUCjQG2XMEBdtn1QKFNrkHB0pNAjXKBTJ73KHvCrK7K/gh0y0QUA8EAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEhAIkIBAgAQEAiToAq2qhiGEy44Pg0DkMxQkh0DyRcgBgQJAID8QKAAE8gOBAkAgP4oEejhCLpCTGQr0wENs5eUFuvRGlUPzE4g3uEUFcrY4ihSCQH4KCRTurLQ4NDuBmMOaXaD4NEdHOgSB/GQUaEKGXFKh1/7H3ATiDqikQPGz3R4KOPTacfjPzARiD6aGUViAjAqN1OmBQH4qEKjJ4dCrxZ2OeQnEH8Y6BBLNqF3q9MxKIIEQ1iJQI9EM+dXpgUB+KhKo4XQoxp2OOQkk0YbXJRCLQrHq9MxIIJEkoDaBGopD0c3OgDkJJHHSCgVqJjk0wZ2O+Qh0CtkXHmIrr1GgtFHZVHc6ZiPQKV7Ht54HJoH2X1+aZrtare6nniGdGIVI7nTMR6DjA1Z/OAXa3rYPNhaDxALkbYamJDwW5iLQoANjPS+fQB/PT+2D3S8/pp1hIlaFmNzpmJ9AvOdVItB1chbPyaHXE6mn8DATgaT8YRPo8fOPTdeF3XrPEEjpD4fElDjg9fXhgVmbM/MQSMwfvlHY/nH16aVZ37w5zxDdvMQrdG5wGCYYpy4aJ5NRIOYEqFE7jA+/0OuuKs0h110Gl8xMIPYzcwnUNkA3v9+tVpYebFqAPM2QM83xjsrifLliFgLJ+cMm0Pq+2Rh7AjlQCjaFginyUI1pxlwwB4EE/eGcB+omE3mH8WOHIhNlqjJjBN9dliW/MRwCwZ8ANdoFOiskNsoKMYMWSLIB4uvCDl3XsAtj+oR9+VJKHkP9Ah1bYhF/2AT6eO6uYfiG8ZPoWp4Js4tszECg/odQCJUO4zsGGXM5haoXSDIBavQKdD3cKuTQbAQSOj23QCxJtCNjLqJQ7QIJ+6OvBfIPt/IrVLlA0v7oEijmSnruZmiGAv3EQ2zlT0dsP//YmAumdtb9iH36isTomZ68CtUtkNUf1hLiBfp4fto/Pm1t4/TmPH5fT7qUkbqIJ6NDVQt0mAIaReunUgLtv760bZAtSW4Oa6INE5LoaZPMuRyqW6D+h6A/aS3Q5uZtY2+BpgpEuUKRR6GaBcrgT1IO1CZAu58dOdCx67JNRbvKIF/fyqFQ/QIJJkAN4yhsk5ZEc10cFXeoYoFsDRB7IUWG8byX1mUdqlegLP7wDeOjyxC4tC6pUO0CCfvDNoyPK0NsVc+U24HiqFygYVgk/OEaxsecQXhNGLdC7/2PagW6aoBE/OEaxhPLYILPofeW/hFr5e3RE4lPJn/YhvG0Mtjg6MrO8hiib0o58Nk+0er7u5xAQ3/KC0Qt4+o6nAwse9+cRYx/+d1q3rVtHqNld2f+kK8FukyAxGJeZBgfc5W3BKOm50D0y+8n49054qZte3ILdPqvXFQTBNp4mmj7M6ctqi/k0LtNn4R39+O5a4HcOeL+8TabQFcdGH8RBxJGYd0Y3tVE08q4JLdCDnkM8ZX/eF7Z78w9sV1lEuiqA2Mv4UTSMH7/jTKMTyJjM+Sxp6l0GJ+tA0scxn/8+pJLoD5RmvTEJPz2NHzvLnnBXQIXDdBFHL8zEVv50xHtEH5rj0DsGVKRVihoT8M1jCcuuEvjYdwAXQbxO2thqtZEW5BzKMaehuvdpSy4S8brz3def9QL1Mj04HHyGOoT6LIDG/2R25+0mejEYXx8GQGYm6HItqcnaRR287srRbQtuBPaneOiARr9jd2ftGG8WBlh2BxKkceQMA90v/VcK0xccDedvP6kDePFyoiBY1SWak+TNhPdCpRvlOqgy6Bd/nAWdCBlJto7SUYqIxKaQhPsaZJbIM9MNL2IGEYNkLw/XDlQrq86mNwMTbOnSZ6JDvkjnUS7/RHovgxMOVDGrzqY4NBke5rqZqKHHdgoTkL+cOVAeb/qIMkhij1NbQJ1/hwEyuJPUhfmyYGyf1dGpEJEe5romeivL4fJaNc0R55LGaMGaPB7MX+SujDviru4rzrgJOhQ0nyPC6bK57mUkd8fvpno8Fcd8OPryljsaSqbiX6wd2CC/tRwKcOL3SEue5roLuybf/onj0CDBiiXPykCeYep5o+mf8/9fWHNtUN88hgiK78ODOCn7B2QzIO1A7vU5w8mYit/Xg/kW7JpAmT+VkCgZpgOMbY9PdGV3/gVynApY9iBnX977Q9TcT2pw3jv/kCOGw+z3NZjHGK3p0meSCxysbln2IGdfyvsD1cLdOjjt9bL0XnuC3t/F1k7FFt5cy0+/SpGUhEBzg3QOQyX6Q+3Pnw50KGP3ww/gdm+TKQ5JT7862DjKk/Qh0ugcwOU0x+2UVjfPvV3P007A4FRz8V8gxnPKIyhiBCnDPr8wi/8EdCn/mG8L21O3rLWRi2XMk4dmMufP0T8iRUoPFUfLsOxrJ8EU9rskaoSgR4erjqwS38YSrHA3QKljMK8t4tEIDHouqIWgfz+SOmjsQuLdSiHPU0tAp07sONvMvkTLZC51PWv5/CCqWllXBJ0KJM9TU0CmZ/Z/YkWaH3f7O5u7VeT+wN4Z1p97VA+e5pKBLrqwIbBk9QnJYluugU/rkXjAssV7A5lSXwG1CBQm0GPO7BczU/DJpDU1eZLhzLb01Qi0EUHlq35adQL1Awdym9PU4VAJ38OAuX0h68Lk1yuYDqzIvY0lQjUdWA2f4hnjiBWoNDuE7LLFd7fmSYe09Ev0EUHdg6TfPPTaJwHuuKYNpdxqAaBBv58z+yPfoHGXVd+h9QL9PDQd2Ddf7L7o1wg25g9c0MkKBDPcpe+AbrsvzLpo1og94xPToe0t0AHfw4N0PG32fzRK1Bo1JXLoSoEuvAnnz5aBYobs2dpiJQLNOzASvijUaCUixXyDtUg0IU/5AqloE6g9AlDWYl0C3TtT9bmp5EVKH2UMXm6Wc4h1QK1Q/iDP98L+aOpBSJerBBqiHQLdGyATv7w1CgBNQKxXOsSkEizQJf+ZG9+Gi0CMV4pZVyx36FaoMMIvqA/GgQSuc4e/V0PIRQLZBqg0v7kFMj6AnMvMDwTKZhmgfoOrK9pGX3ytkBx+4UoQ69AxxFYUX9KdmFXjY9Kk9QK1HVgzdEfzvokUUwgX9elSSK9Ah0SoKZg89OUEiic+KhpibQK9PDliwZ/uARK2ak+Om1WIZFegZqjP8zVSYNRoLid6hNHXcUdUirQwB/t8YkVKGaj8Wlj9qItkVKB2g6s86d4E51RINKMTzGJdAr0YBIgDf6wCRSxUz15wrCIRFwC8e4dYDowFf7wjcIy7VSfXSKmyvPuHdA2QK0/EwPxykRs5YvfF3ZFVol4Ks986zfBn+Mbz0WNAnXkkkijQG0DNNEfbn0qFsiQoyni6sI49w7o/Emvwyu/PoxJtOfeedmBjLBFXJVn3Dug9WfCKxbRh7EFcm5dlmMkLCiRwmH8BH+E7GkYBfp4vvpw5dyp/ngtn/20+obxX1L9eZXTp/Ic6Bp+idQN4x+S/BGVxzAzgQyRX3QVibpR2PfY+g9na+SYoUAhgoKNJNMmUND/y5k+YbgFKvZ9YbycHRIcxl/kiFFi//FHcIb4PROx8ZldC5SGwmG8KiBQAIXDeFXwzQMt9hNWQxFycAnkHaZWTVI4g1hzxKoJvuT4NdGuAMWfqLJDeNH0yjjjA4EyoemVZRfIe7U5/kSVHZLCum/wbTlifIGVHZJ0oGeYGn+iyg5JwJcjxhdY2SGJBzKcqLJD4llyFw+BGIBADGh6afm7sOXmiBCIheXmiFXPk4LyQCBAAgIBEhAIkIBAgAQEAiQgECABgQAJCARIQCBAAgIBEmSBPp5PW3YMHroO2d2tVk/+Q1zXtMcFWS87jQv69GKt8OnsruryMvf4kAVa356vRd/aV1Sdf79/fGq2toqPnrq21ntY0M3b7mfvWUxBG+tpzH6P/uryMvf4UAUyS2EOzg4eug7Z3rw1/X6vzkPag/5k+4RdFBSoi/lhPWyz+uvh7K7q8jL7+FAFGtTEVamL3xv5fYd8/PM/tmpfFBSoi3kXtrbFOf99Oz7bGUNWZh+f/AJtLPUeHrK5twZgcMj25t/WTGEU5ueVY3GXdoEqi092gaw97+CQ/d/fggFqM0RbpjA8y+O9o4/XLlBt8ckt0Maa+w8OWT/Zm+DRJ8yeKUTUpdEuUHXxyZtEu6w/H3LYz9ObR5ofgVQzIkAak+gK45N3GG8dXF491V7tYUFtE22L9PkQs6djoInWOIyvMD5kgdqPhKlIW+fjQ88ha8fHZ3gWV4AGh5iJMtt02+CQwESZr7q8zD0+uJQBSEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkNApkNsnxfu/EwlEVH5UCmTuTzN3bwIqq+KgVyH5vJWiUxUevQObe7G3bVB9usN3I34VcC6rio1egj+enw45vrs0Cloqq+KgWyPyn/aCZR/L7aNSDqvjoFajbXqQdb3x6Mc3zRkfKqAJV8dErUJskmt1OTJz23377VXonqIpQFR+1AplhqhlorM0uJOt//MX5bbbLQ1V8VAp0d9glx+xz8zfT1W+t290sFVXx0SjQNUih/RSMTx0CYRLIT8H41CDQ7k7HpKtWisanBoGAYiAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJP4fvEddmGzgA58AAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="projection-from-survey-1" class="section level4">
<h4>Projection from survey</h4>
<p>Project forward one year, matching given average relative abundance and total biomass over a set of reference time steps obtained from a survey</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection given relative abundance and total</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">## biomass estimated from a five day mid-year survey (days 150 to 154)</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>Nsurvey <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.67</span>, <span class="fl">0.46</span>, <span class="fl">0.33</span>, <span class="fl">0.25</span>, <span class="fl">0.18</span>, <span class="fl">0.13</span>) </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>Bsurvey <span class="ot">&lt;-</span> <span class="dv">15000</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="fl">1954.908</span>, <span class="at">Nref=</span>Nsurvey, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">nref=</span><span class="dv">151</span><span class="sc">:</span><span class="dv">155</span>, <span class="at">Bref=</span>Bsurvey, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
<p>This determines the fishing mortality required to reproduce the target yield</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fishing mortality and total annual yield</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>F</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1954.908</span></span></code></pre></div>
<p>Plot the initial age structure and resulting profiles of abundance, biomass and yield by age class</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot initial abundance, projected abundance, biomass and yield</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>Ages, <span class="at">y=</span>pr<span class="sc">$</span>N[<span class="dv">1</span>,], <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>N, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>B, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Days, <span class="at">y=</span>pr<span class="sc">$</span>Y, <span class="at">xlab=</span><span class="st">&quot;Day&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="unattainable-target" class="section level4">
<h4>Unattainable target</h4>
<p>If the target catch cannot be recovered without exceeding <code>Fmax</code>, the projection is performed with <code>F</code> capped at <code>Fmax</code></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Unattainable target catch - F is capped at Fmax</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="dv">2</span>, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>, <span class="at">Fmax=</span><span class="fl">2.5</span>)</span></code></pre></div>
<p>the yield does not match the target</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Yield does not match target</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr<span class="sc">$</span>Y[nsteps<span class="sc">+</span><span class="dv">1</span>,])</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.463323</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>F<span class="sc">==</span><span class="fl">2.5</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div id="multi-year-projection-1" class="section level4">
<h4>Multi-year projection</h4>
<p>Project forward 10 years from a virgin stock assuming constant catch, collating annual abundance, biomass and yield.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural mortality and no fishing, assuming no plus class and 8000 recruits per year.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and 8000</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming constant catch, update the the initial abundance for the next projection assuming 8000 new recruits, and record the final abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant catch</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">projectC</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs, <span class="at">Catch=</span><span class="dv">4000</span>, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age class</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="advance" class="section level2">
<h2>advance</h2>
<p>The <code>advance</code> function constructs the initial abundance for the next annual projection given the projected abundances for the current year. Essentially, <code>advance</code> advances the final abundance of each cohort by an age class filling the first age class with recruits. If the last age class is a plus class, the surviving individuals of the plus class are retained when the classes advance, otherwise these individuals are lost to the population.</p>
<div id="setup-2" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Define the intra-annual fishing mortality, its integral and the annual scaling, assuming fishing occurs on days 80 to 119 and there is length based selectivity</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define fishing mortalities - mid-year fishing with length based selectivity </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>fs[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fs<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fs<span class="sc">*</span><span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Compute an intial age structure assuming constant mortalities</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0)</span></code></pre></div>
<p>The projected final abundance is</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Final abundance</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>N[nsteps<span class="sc">+</span><span class="dv">1</span>,]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span> <span class="fl">0.1794040</span></span></code></pre></div>
</div>
<div id="advance-1" class="section level4">
<h4>Advance</h4>
<p>Advance the final cohort numbers by one age class to form the initial numbers for the next projection. If the final age class is not a plus group individuals in the final age class are discarded in the advancement</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial abundance for next projection assuming no plus group</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">1</span>, <span class="at">plus=</span><span class="cn">FALSE</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>If the final age class is a plus group the individuals in the final age class are retained</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial abundance for next projection assuming plus group</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">1</span>, <span class="at">plus=</span><span class="cn">TRUE</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.4215740</span></span></code></pre></div>
</div>
<div id="project-without-plus-class" class="section level4">
<h4>Project without plus class</h4>
<p>Project forward 10 years from a virgin stock assuming constant fishing mortality, collating annual abundance, biomass and yield, assuming the final class is not a plus class.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages)) <span class="co">#produce identical matrices Nf, Bf and Yf</span></span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural mortality and no fishing, assuming no plus class and 8000 recruits per year.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and 8000</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming constant fishing mortality, update the the initial abundance for the next projection assuming 8000 new recruits, and record the final abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant fishing mortality</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age class</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="project-with-plus-class" class="section level4">
<h4>Project with plus class</h4>
<p>Project forward 10 years from a virgin stock assuming constant fishing mortality, collating annual abundance, biomass and yield, assuming the final class is a plus class.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance, biomass and yield</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural mortality and no fishing with 8000 recruits per year. Treat the last class as a plus group assuming an additional 50 age classes are aggregated into the plus class</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing, 8000</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="do">## new recruits each year and a plus class</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>, <span class="at">plus=</span><span class="dv">50</span>)</span></code></pre></div>
<p>For each year, project forward from the initial abundance assuming constant fishing mortality, update the the initial abundance for the next projection assuming 8000 new recruits and assuming the last class is a plus class, and record the final abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project forward with constant fishing mortality assuming plus class</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>Nf)) {</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>, <span class="at">plus=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  Nf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  Bf[k,] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  Yf[k,] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age class</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance, biomass and yield</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="projectmf" class="section level2">
<h2>projectMF</h2>
<p>The <code>projectMF</code> is a multifleet variation of the the <code>project</code> function, that projects abundance, biomass and yield by age class forward over one year when natural and fishing mortalities for each fleet are known.</p>
<div id="setup-3" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort, assuming fishing occurs on days 80 to 219, but split into two fleets,</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>fwy1 <span class="ot">&lt;-</span> fwy2 <span class="ot">&lt;-</span> fwy</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Fleet 1 doesn&#39;t fish from day 150 to 219</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>fwy1[<span class="dv">151</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Fleet 2 doesn&#39;t fish from day 80 to 149</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>fwy2[<span class="dv">81</span><span class="sc">:</span><span class="dv">150</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
<p>Define a length based selectivity</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral and the annual scaling.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>,<span class="fu">c</span>(nsteps<span class="sc">+</span><span class="dv">1</span>,<span class="fu">length</span>(Ages),<span class="dv">2</span>))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>fs[,,<span class="dv">1</span>] <span class="ot">&lt;-</span> fwy1<span class="sc">*</span>ss</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>fs[,,<span class="dv">2</span>] <span class="ot">&lt;-</span> fwy2<span class="sc">*</span>ss</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> Fs[<span class="fu">nrow</span>(Fs),,] <span class="co">#final(P=Fs)</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>)</span></code></pre></div>
</div>
<div id="projection-from-equilibrium-2" class="section level4">
<h4>Projection from equilibrium</h4>
<p>Project forward one year from an equilibrium age structure.</p>
<p>Compute an intial age structure assuming constant mortalities and assuming no plus class</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>Fsf<span class="sc">%*%</span>F)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities. A yield for each fleet is returned</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale by F</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>FFs <span class="ot">&lt;-</span> <span class="fu">scale3</span>(Fs,F,<span class="at">sum=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>Ffs <span class="ot">&lt;-</span> <span class="fu">scale3</span>(fs,F,<span class="at">sum=</span><span class="cn">FALSE</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectMF</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>FFs, <span class="at">Ffs=</span>Ffs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>Y</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>             [,<span class="dv">1</span>]        [,<span class="dv">2</span>]</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">0.000000e+00</span> <span class="fl">0.000000000</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="fl">6.734637e-05</span> <span class="fl">0.006562206</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="fl">3.991119e-02</span> <span class="fl">0.036911371</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="fl">3.515529e-02</span> <span class="fl">0.031953748</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="fl">2.880503e-02</span> <span class="fl">0.025928265</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>,] <span class="fl">2.265132e-02</span> <span class="fl">0.020274516</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">7</span>,] <span class="fl">1.738998e-02</span> <span class="fl">0.015513548</span></span></code></pre></div>
<p>The total yield per fleet is</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(pr<span class="sc">$</span>Y)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1439802</span> <span class="fl">0.1371437</span></span></code></pre></div>
</div>
</div>
<div id="projectcmf" class="section level2">
<h2>projectCMF</h2>
<p>The <code>projectCMF</code> is a multifleet variant of the the <code>projectC</code> function, that projects abundance, biomass and yield by age class forward over one year when natural and total annual yield for each fleet are known.</p>
<div id="setup-4" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort, assuming fishing occurs on days 80 to 219, but split into two fleets,</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>fwy1 <span class="ot">&lt;-</span> fwy2 <span class="ot">&lt;-</span> fwy</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Fleet 1 doesn&#39;t fish from day 150 to 219</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>fwy1[<span class="dv">151</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Fleet 2 doesn&#39;t fish from day 80 to 149</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>fwy2[<span class="dv">81</span><span class="sc">:</span><span class="dv">150</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
<p>Define a length based selectivity</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral and the annual scaling.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>,<span class="fu">c</span>(nsteps<span class="sc">+</span><span class="dv">1</span>,<span class="fu">length</span>(Ages),<span class="dv">2</span>))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>fs[,,<span class="dv">1</span>] <span class="ot">&lt;-</span> fwy1<span class="sc">*</span>ss</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>fs[,,<span class="dv">2</span>] <span class="ot">&lt;-</span> fwy2<span class="sc">*</span>ss</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> Fs[<span class="fu">nrow</span>(Fs),,] <span class="co">#final(P=Fs)</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>)</span></code></pre></div>
</div>
<div id="projection-from-equilibrium-3" class="section level4">
<h4>Projection from equilibrium</h4>
<p>Project forward one year from an equilibrium age structure.</p>
<p>Compute an intial age structure assuming constant mortalities and assuming no plus class</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>Fsf<span class="sc">%*%</span>F)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities. A yield for each fleet is returned</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale by F</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>FFs <span class="ot">&lt;-</span> <span class="fu">scale3</span>(Fs,F,<span class="at">sum=</span><span class="cn">TRUE</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>Ffs <span class="ot">&lt;-</span> <span class="fu">scale3</span>(fs,F,<span class="at">sum=</span><span class="cn">FALSE</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectMF</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>FFs, <span class="at">Ffs=</span>Ffs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>Y</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>             [,<span class="dv">1</span>]        [,<span class="dv">2</span>]</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">0.000000e+00</span> <span class="fl">0.000000000</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="fl">6.734637e-05</span> <span class="fl">0.006562206</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,] <span class="fl">3.991119e-02</span> <span class="fl">0.036911371</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,] <span class="fl">3.515529e-02</span> <span class="fl">0.031953748</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,] <span class="fl">2.880503e-02</span> <span class="fl">0.025928265</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>,] <span class="fl">2.265132e-02</span> <span class="fl">0.020274516</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>[<span class="dv">7</span>,] <span class="fl">1.738998e-02</span> <span class="fl">0.015513548</span></span></code></pre></div>
<p>These catches should give <code>F=0.2</code> for each fleet</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">projectCMF</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">Fs=</span>Fs, <span class="at">fs=</span>fs,<span class="at">Catch =</span> <span class="fu">c</span>(<span class="fl">0.1439802</span>,<span class="fl">0.1371437</span>), <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>,<span class="at">Fmax=</span><span class="dv">5</span>,<span class="at">tol=</span><span class="fl">1.0E-6</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(pr<span class="sc">$</span>Y)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1439802</span> <span class="fl">0.1371437</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>F</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2000001</span> <span class="fl">0.2000001</span></span></code></pre></div>
</div>
</div>
<div id="rescaleprojection" class="section level2">
<h2>rescaleProjection</h2>
<p>The <code>rescaleProjection</code> function rescales an existing projection to reproduce a prescribed reference abundance or biomass.</p>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort, assuming fishing occurs on days 80 to 119, and define a length based selectivity</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral and the annual scaling.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Project forward 10 years from a virgin stock assuming constant fishing mortality, collating annual abundance, biomass and yield.</p>
<p>Create matrices to store annual projections</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten year projection from virgin stock collating final annual</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="do">## abundance,  biomass and yield</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>Years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>Nf <span class="ot">&lt;-</span> Bf <span class="ot">&lt;-</span> Yf <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Years), <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span></code></pre></div>
<p>Compute an equilibrium age structure assuming constant natural mortality and no fishing, assuming no plus class and 8000 recruits per year.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span></code></pre></div>
<p>For the first year, project forward from the initial abundance assuming constant fishing mortality, update the the initial abundance for the next projection assuming 8000 new recruits, and record the final abundance, biomass and yield from the projection</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Project first year</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">1</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>Nf[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>Bf[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>Yf[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span></code></pre></div>
<p>As the mortalities are constant from year to year, the projections for the subsequent years can be computed by rescaling the initial projection</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute projections for subsequent years by rescaling</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(Nf)) {</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> <span class="fu">rescaleProjection</span>(<span class="at">pr=</span>pr, <span class="at">Nref=</span>N0)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  N0 <span class="ot">&lt;-</span> <span class="fu">advance</span>(<span class="at">N=</span>pr<span class="sc">$</span>N, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  Nf[k, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  Bf[k, ] <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>B)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  Yf[k, ] <span class="ot">&lt;-</span> pr<span class="sc">$</span>Y</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Plot final abundance, biomass and yield for each year by age class</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot annual abundance,  biomass and yield</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">hcl</span>(<span class="at">h=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">15</span>, <span class="at">to=</span><span class="dv">375</span>, <span class="at">length=</span><span class="dv">8</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">l=</span><span class="dv">65</span>, <span class="at">c=</span><span class="dv">100</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Nf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Bf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Biomass&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Years, <span class="at">y=</span>Yf, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Yield&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span>pal)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="agestructured" class="section level2">
<h2>ageStructureD</h2>
<p>The <code>ageStructureD</code> function computes the equilibrium age structure of the population assuming the recruitment and the annual scalings of natural and fishing mortality are constant</p>
<div id="setup-5" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="age-structure" class="section level4">
<h4>Age structure</h4>
<p>Compute and initial age structure assuming no fishing and no plus group</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no fishing and no plus</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="do">## group</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span></code></pre></div>
<p>Projecting forward with the same mortality used to compute the equilibrium age structure should leave the abundances stable</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms,<span class="at">Nref=</span>N0)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial and final abundance</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>pr<span class="sc">$</span>N[<span class="fu">c</span>(<span class="dv">1</span>,nsteps<span class="sc">+</span><span class="dv">1</span>),]</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>          [,<span class="dv">1</span>]      [,<span class="dv">2</span>]      [,<span class="dv">3</span>]      [,<span class="dv">4</span>]      [,<span class="dv">5</span>]      [,<span class="dv">6</span>]      [,<span class="dv">7</span>]</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,] <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span> <span class="fl">0.2465970</span></span></code></pre></div>
<p>The deterministic age structure should match the stochastic age structure for constant recruitment and mortalities. If the last class is not a plus class</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure with no plus class</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Stochastic initial age structure with constant recruitment</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">0.3011942</span></span></code></pre></div>
<p>If the last class is a plus class aggregrating 50 additional age classes</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming the plus class</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="do">## aggregates 50 additional age classes</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">plus=</span><span class="dv">20</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">1.6366683</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Stochastic initial age structure with constant recruitment with</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="do">## plus class</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">7</span><span class="sc">+</span><span class="dv">20</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M, <span class="at">plus=</span><span class="cn">TRUE</span>)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">1.6366683</span></span></code></pre></div>
<p>For the deterministic computation, the plus class can contain an infinite number of additional age classes</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure assuming no upper limit on age</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">plus=</span><span class="cn">Inf</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.8187308</span> <span class="fl">0.6703200</span> <span class="fl">0.5488116</span> <span class="fl">0.4493290</span> <span class="fl">0.3678794</span> <span class="fl">1.6615847</span></span></code></pre></div>
</div>
<div id="scaling" class="section level4">
<h4>Scaling</h4>
<p>By default the scaling of the abundances are determined by the level of recruitment</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale to recruitment</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="dv">8000</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">8000.000</span> <span class="fl">6549.846</span> <span class="fl">5362.560</span> <span class="fl">4390.493</span> <span class="fl">3594.632</span> <span class="fl">2943.036</span> <span class="fl">2409.554</span></span></code></pre></div>
<p>Alternately, the age structure can used as a relative abundances and scaled to a mid-year survey biomass with <code>project</code></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Scale age structure to biomass estimated from a five day mid-year</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="do">## survey (days 150 to 154)</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>Bsurvey <span class="ot">&lt;-</span> <span class="dv">15000</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span><span class="dv">0</span>, <span class="at">Ffs=</span><span class="dv">0</span>, <span class="at">Nref=</span>N0, <span class="at">nref=</span><span class="dv">1</span>, <span class="at">Bref=</span>Bsurvey, <span class="at">bref=</span><span class="dv">151</span><span class="sc">:</span><span class="dv">155</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">initial</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">7627.544</span> <span class="fl">6244.904</span> <span class="fl">5112.895</span> <span class="fl">4186.085</span> <span class="fl">3427.276</span> <span class="fl">2806.016</span> <span class="fl">2297.372</span></span></code></pre></div>
</div>
</div>
<div id="agestructures" class="section level2">
<h2>ageStructureS</h2>
<p>The <code>ageStructureS</code> function computes a stochastic initial age structure of the population assuming both the recruitment and the annual scalings of natural and fishing mortalities may vary inter-annually.</p>
<div id="setup-6" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="log-normal-recruitment" class="section level4">
<h4>Log Normal Recruitment</h4>
<p>Compute an initial age structure assuming numbers of recruits are log Normally distributed. Recruitment must be simulated for at least as many years as there are age classes with non neglible abundance in the population (including age classes aggregated into the plus group).</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Stochastic initial age structure with log Normal recruitment</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">11.213908</span>  <span class="fl">9.769203</span>  <span class="fl">7.797952</span>  <span class="fl">6.590497</span>  <span class="fl">4.360927</span>  <span class="fl">4.180172</span>  <span class="fl">3.386295</span></span></code></pre></div>
<p>Compare 100 stochastic structures based on log Normal recruitment to the corresponding deterministic age structure</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot 100 replicates</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>Rs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">100</span>, </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">expr=</span><span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Rs,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="fu">exp</span>(<span class="at">x=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fl">0.1</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)), <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be more efficient to base each simulated profile on the previous but simulate forward fewer years.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>Rs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">length</span>(<span class="at">x=</span>Ages), <span class="at">ncol=</span><span class="dv">100</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>Rs[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>M)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(<span class="at">x=</span>Rs))</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  Rs[,k] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">meanlog=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>), <span class="at">sdlog=</span><span class="fl">0.2</span>),<span class="at">Msf=</span>Msf, <span class="at">M=</span>M, <span class="at">N0=</span>Rs[,k<span class="dv">-1</span>])</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x=</span>Rs, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">R=</span><span class="fu">exp</span>(<span class="at">x=</span><span class="fu">log</span>(<span class="at">x=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fl">0.1</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)), <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="stock-summary" class="section level2">
<h2>Stock Summary</h2>
<p>The <code>spawningStock</code> function extracts the spawning stock abundance or biomass from a projection, while <code>vulnerableStock</code> and <code>vulnerableStockGYM</code> extracts abundance or biomass vulnerable to fishing from a projection.</p>
<div id="setup-7" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the normalized intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.1</span></span></code></pre></div>
<p>Create the vector of within year distribution of fishing effort, assuming fishing occurs on days 80 to 119, and define a length based selectivity</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normalized within year distribution of fishing effort</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> <span class="fu">double</span>(<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>fwy[<span class="dv">81</span><span class="sc">:</span><span class="dv">220</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>fwy <span class="ot">&lt;-</span> fwy<span class="sc">/</span><span class="fu">trapz</span>(<span class="at">fs=</span>fwy, <span class="at">h=</span>h)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Length based selectivity</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">420</span>, <span class="at">xrange=</span><span class="dv">30</span>)</span></code></pre></div>
<p>Define the normalized intra-annual fishing mortality, its integral and the annual scaling.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Intra-annual fishing mortality - effort by selectivity</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> fwy<span class="sc">*</span>ss</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>Fs <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>fs, <span class="at">h=</span>h)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>Fsf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Fs)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Compute an intial age structure assuming constant mortalities and assuming no plus class</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deterministic initial age structure</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">ageStructureD</span>(<span class="at">MMsf=</span>M<span class="sc">*</span>Msf, <span class="at">FFsf=</span>F<span class="sc">*</span>Fsf)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>N0</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span></code></pre></div>
<p>Project forward for a single year with known mortalities</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Annual projection from N0</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">project</span>(<span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">FFs=</span>F<span class="sc">*</span>Fs, <span class="at">Ffs=</span>F<span class="sc">*</span>fs, <span class="at">Nref=</span>N0, <span class="at">yield=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="initial-and-final" class="section level4">
<h4>Initial and Final</h4>
<p>Extract the initial and final abundances in each age class</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Initial abundance</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">initial</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.0000000</span> <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Final abundance</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu">final</span>(<span class="at">P=</span>pr<span class="sc">$</span>N)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.9048374</span> <span class="fl">0.8040328</span> <span class="fl">0.5956421</span> <span class="fl">0.4412625</span> <span class="fl">0.3268953</span> <span class="fl">0.2421700</span> <span class="fl">0.1794040</span></span></code></pre></div>
</div>
<div id="spawning-stock" class="section level4">
<h4>Spawning Stock</h4>
<p>Determine the fraction mature at age from length at age</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Maturity at age</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">410</span>, <span class="at">xrange=</span><span class="dv">40</span>)</span></code></pre></div>
<p>If the spawning period is from day 200 to day 280 (time steps 201 to 281)</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Increments in the spawning period</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>spawn <span class="ot">&lt;-</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">281</span></span></code></pre></div>
<p>then the spawning stock abundance and biomass are</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Spawning stock abundance</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>N, <span class="at">gs=</span>gs, <span class="at">period=</span>spawn)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.414319</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Spawning stock biomass</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">gs=</span>gs, <span class="at">period=</span>spawn)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.499233</span></span></code></pre></div>
</div>
<div id="exploitable-and-vulnerable-stock" class="section level4">
<h4>Exploitable and Vulnerable Stock</h4>
<p>The <code>exploitableStock</code> function calculates the mean abundance or biomass that can be exploited by scaling the abundance or biomass by selectivity, <code>vulnerableStock</code> computes the effort weighted mean exploitable stock abundance or biomass.</p>
<p>If the exploitable and vulnerable biomass are identical when fishing effort is constant within the monitoring period</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Monitoring period within fishing season</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>monitor <span class="ot">&lt;-</span> <span class="dv">101</span><span class="sc">:</span><span class="dv">151</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Exploitable biomass</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exploitableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">period=</span>monitor)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.419356</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Weighted vulnerable biomass</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vulnerableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">fwy=</span>fwy, <span class="at">period=</span>monitor)</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.419356</span></span></code></pre></div>
<p>but may differ if the fishing effort varies varies within the monitoring period</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Monitoring period spans fishing season</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>monitor <span class="ot">&lt;-</span> <span class="dv">41</span><span class="sc">:</span><span class="dv">101</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Exploitable biomass</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exploitableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">period=</span>monitor)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.498579</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Vulnerable biomass weights by effort</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vulnerableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">fwy=</span>fwy, <span class="at">period=</span>monitor)</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.477055</span></span></code></pre></div>
<p>If the monitoring period is outside the fishing season, vulnerable biomasss is zero</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## No effort in monitoring period</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>monitor <span class="ot">&lt;-</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">31</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Exploitable biomass</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exploitableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">period=</span>monitor)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.460039</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Vulnerable biomass weights by effort</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vulnerableStock</span>(<span class="at">P=</span>pr<span class="sc">$</span>B, <span class="at">ss=</span>ss, <span class="at">fwy=</span>fwy, <span class="at">period=</span>monitor)</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span></code></pre></div>
</div>
</div>
<div id="spawningb0d" class="section level2">
<h2>spawningB0D</h2>
<p>The <code>spawningB0D</code> function provides a deterministic estimate of the virgin spawning stock biomass by deterministically computing the virgin age structure and projecting forward to compute the spawning biomass.</p>
<div id="setup-8" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.128707</span></span></code></pre></div>
</div>
<div id="virgin-spawning-biomass" class="section level4">
<h4>Virgin Spawning Biomass</h4>
<p>Determine the fraction mature at age from length at age</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Maturity at age</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls, <span class="at">x50=</span><span class="dv">410</span>, <span class="at">xrange=</span><span class="dv">40</span>)</span></code></pre></div>
<p>If the spawing period is from day 200 to day 280 (time steps 201 to 281)</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Increments in the spawning period</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>spawn <span class="ot">&lt;-</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">281</span></span></code></pre></div>
<p>then the deterministic estimate of virgin spawning stock biomass is</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Virgin spawning stock abundance</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningB0D</span>(<span class="at">gs=</span>gs, <span class="at">ws=</span>ws, <span class="at">MMs=</span>M<span class="sc">*</span>Ms, <span class="at">spawn=</span>spawn)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.170942</span></span></code></pre></div>
</div>
</div>
<div id="spawningb0s" class="section level2">
<h2>spawningB0S</h2>
<p>The <code>spawningB0S</code> function provides a stochastic estimate of the virgin spawning stock biomass by repeatedly simulating the virgin age structure and projecting forward to compute the spawning biomass.</p>
<div id="setup-9" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="dv">1</span>,<span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days,<span class="at">Y=</span>Ages,<span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages,<span class="at">t0=</span><span class="fl">0.0667</span>,<span class="at">K=</span><span class="fl">0.5</span>,<span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>,<span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms,<span class="at">h=</span>h))</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms,<span class="at">h=</span>h)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span></code></pre></div>
</div>
<div id="random-recruits" class="section level4">
<h4>Random Recruits</h4>
<p>Calculate model parameters for the proportional recruitment model when <span class="math inline">\(R\)</span> has mean and variance 0.3 and 0.01</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">Msf=</span>Msf,<span class="at">mnR=</span><span class="fl">0.2</span>,<span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.128707</span></span></code></pre></div>
<p>Generate 1000 sets of 10 recruitment events</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10000</span>,<span class="at">ps=</span>ps),<span class="at">nrow=</span><span class="dv">1000</span>,<span class="at">ncol=</span><span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="virgin-spawning-biomass-1" class="section level4">
<h4>Virgin Spawning Biomass</h4>
<p>Determine the fraction mature at age from length at age</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Maturity at age</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">rampOgive</span>(<span class="at">x=</span>ls,<span class="at">x50=</span><span class="dv">410</span>,<span class="at">xrange=</span><span class="dv">40</span>)</span></code></pre></div>
<p>If the spawing period is from day 200 to day 280 (time steps 201 to 281)</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Increments in the spawning period</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>spawn <span class="ot">&lt;-</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">281</span></span></code></pre></div>
<p>then estimates of the median, mean and standard deviation of the virgin spawning stock biomass are</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Virgin spawning stock abundance</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spawningB0S</span>(<span class="at">R=</span>R,<span class="at">gs=</span>gs,<span class="at">ws=</span>ws,<span class="at">Ms=</span>Ms,<span class="at">M=</span>ps<span class="sc">$</span>M,<span class="at">spawn=</span>spawn)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>median</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.136381</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mean</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.168495</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>sd</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5059054</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1000</span></span></code></pre></div>
</div>
</div>
<div id="prrecruits" class="section level2">
<h2>prRecruits</h2>
<p>Grym offers several variants of the proportional recruitment model implemented in the GYM.</p>
<p>Let <span class="math inline">\(A_{k}\)</span> be the number of individuals in age class <span class="math inline">\(k\)</span> and define <span class="math display">\[
R = \frac{A_{r}}{\sum_{k=r} A_{k}}
\]</span> the number of individuals in age class <span class="math inline">\(r\)</span> as a proportion of all individuals of that age or older. Given estimates of the mean and variance of <span class="math inline">\(R\)</span> from independent surveys, the proportional recruitment model determines the scaling of natural mortality M and the distribution of random recruits that will reproduce the observed mean and variance of R.</p>
<div id="setup-10" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span></code></pre></div>
<p>Let <span class="math inline">\(R\)</span> be the proportion of the number of recruits as a fraction of the total population.</p>
</div>
<div id="inverse-beta" class="section level4">
<h4>Inverse Beta</h4>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.1, </span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3194035</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">92.7501</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsIB</span>(<span class="dv">10</span>, ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">90.47015</span>  <span class="fl">32.01969</span> <span class="fl">122.09970</span> <span class="fl">130.96291</span> <span class="fl">115.35299</span>  <span class="fl">90.70801</span> <span class="fl">167.11166</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">119.57965</span> <span class="fl">109.45715</span>  <span class="fl">74.97870</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.97357</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(R)</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2995861</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(R)</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008611798</span></span></code></pre></div>
<p>The random recruits have a scaled inverse Beta distribution</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Inverse Beta&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2380231</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">93.15843</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">84.86638</span>  <span class="fl">66.54970</span>  <span class="fl">66.80408</span> <span class="fl">109.20433</span> <span class="fl">133.26970</span>  <span class="fl">81.50624</span>  <span class="fl">87.88495</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">107.42938</span>  <span class="fl">47.09156</span> <span class="fl">154.62618</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.0109</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2990801</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008655475</span></span></code></pre></div>
</div>
<div id="gamma" class="section level4">
<h4>Gamma</h4>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3194035</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">93.98026</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">69.92441</span> <span class="fl">203.45146</span> <span class="fl">131.66620</span>  <span class="fl">38.35412</span> <span class="fl">108.96712</span>  <span class="fl">87.20759</span> <span class="fl">145.78009</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">59.75297</span>  <span class="fl">35.21799</span>  <span class="fl">77.91632</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.0044</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3001868</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.009259404</span></span></code></pre></div>
<p>The random recruits have a scaled Gamma distribution</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsG</span>(<span class="dv">100000</span>, ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Gamma&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2380231</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">94.199</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">81.66831</span> <span class="fl">152.83858</span>  <span class="fl">87.50982</span> <span class="fl">120.86496</span> <span class="fl">128.68921</span> <span class="fl">211.07732</span> <span class="fl">112.61542</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">41.02474</span> <span class="fl">175.12732</span>  <span class="fl">64.41595</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.337</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3010805</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.009338703</span></span></code></pre></div>
</div>
<div id="log-normal" class="section level4">
<h4>Log Normal</h4>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3194035</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">91.95218</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">138.03874</span> <span class="fl">129.47150</span> <span class="fl">160.76590</span> <span class="fl">130.09241</span>  <span class="fl">86.97384</span>  <span class="fl">85.14723</span>  <span class="fl">76.75983</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">66.15785</span> <span class="fl">122.18054</span>  <span class="fl">57.46816</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.96853</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3007444</span></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008310919</span></span></code></pre></div>
<p>The random recruits have a scaled log Normal distribution</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Log Normal&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2380231</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">92.2145</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">79.70209</span> <span class="fl">153.46635</span>  <span class="fl">92.70952</span> <span class="fl">101.81162</span> <span class="fl">257.00397</span> <span class="fl">138.92325</span> <span class="fl">127.47246</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">97.08298</span>  <span class="fl">52.28850</span>  <span class="fl">76.64355</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.3361</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2995198</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.008442172</span></span></code></pre></div>
</div>
<div id="delta-inverse-beta" class="section level4">
<h4>Delta Inverse Beta</h4>
<p>The Delta-Inverse Beta model may provide a closer fit to abundance data with a zero-inflated distribution.</p>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population,  assuming</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="do">## zero recruitment occurs with probability 0.4</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.672917</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="fl">59.01825</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">20.82949</span> <span class="fl">287.41065</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span> <span class="fl">361.26611</span>  <span class="fl">48.66849</span>   <span class="fl">0.00000</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]   <span class="fl">0.00000</span> <span class="fl">129.90296</span>   <span class="fl">0.00000</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.50824</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3601309</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1154366</span></span></code></pre></div>
<p>The random non-zero recruitment events have a scaled Inverse Beta distribution</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> rs <span class="sc">&lt;</span> <span class="dv">600</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">600</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Delta Inverse Beta&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>But there are many zero recruitment events</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fraction of zero recruitments</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>rs<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.40036</span></span></code></pre></div>
<p>Repeat for the case where R is the proportion of individuals in age class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older,  assuming</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="do">## recruitment occurs with probability 0.4</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDIB</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5928293</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDIB</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="fl">57.55216</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]   <span class="fl">0.0000</span>   <span class="fl">0.0000</span>   <span class="fl">0.0000</span>   <span class="fl">0.0000</span> <span class="fl">455.0719</span>   <span class="fl">0.0000</span> <span class="fl">102.1934</span> <span class="fl">212.2675</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">9</span>]   <span class="fl">0.0000</span>   <span class="fl">0.0000</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.8897</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDIB</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3495691</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1134869</span></span></code></pre></div>
</div>
<div id="delta-gamma" class="section level4">
<h4>Delta Gamma</h4>
<p>The Delta-Gamma model may provide a closer fit to abundance data with a zero-inflated distribution.</p>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population,  assuming</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="do">## zero recruitment occurs with probability 0.4</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.672917</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fl">28.85033</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]   <span class="fl">3.912623</span>   <span class="fl">0.000000</span>   <span class="fl">0.000000</span>   <span class="fl">0.000000</span> <span class="fl">133.441028</span>   <span class="fl">0.000000</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>]  <span class="fl">49.379267</span>  <span class="fl">50.582156</span>  <span class="fl">94.438105</span>  <span class="fl">64.766182</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">102.4009</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3384315</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1238749</span></span></code></pre></div>
<p>The non-zero recruits have a scaled Gamma distribution</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> rs <span class="sc">&lt;</span> <span class="dv">600</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">600</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Delta Gamma&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>But there are many zero recruitment events</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fraction of zero recruitments</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>rs<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.40007</span></span></code></pre></div>
<p>Repeat for the case where R is the proportion of individuals in age class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="do">## fraction of individuals that are that age or older, assuming</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="do">## recruitment occurs with probability 0.4</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDG</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5928293</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDG</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="fl">28.98105</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">48.81632</span>   <span class="fl">0.00000</span>  <span class="fl">93.37600</span>  <span class="fl">76.36627</span> <span class="fl">113.28618</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]   <span class="fl">0.00000</span> <span class="fl">398.04721</span>  <span class="fl">76.15362</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.7471</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDG</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3393254</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1237278</span></span></code></pre></div>
</div>
<div id="delta-log-normal" class="section level4">
<h4>Delta Log Normal</h4>
<p>The Delta-Log Normal model may provide a closer fit to abundance data with a zero-inflated distribution.</p>
<p>Generate model parameters from the mean and variance of <span class="math inline">\(R\)</span>. This computes an estimate of the scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of recruits in the population,  assuming</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="do">## zero recruitment events occur with probability 0.4.</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.1</span>, <span class="at">p=</span><span class="fl">0.4</span>)</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4421236</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fl">75.09216</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]   <span class="fl">0.00000</span>   <span class="fl">0.00000</span>  <span class="fl">52.87096</span> <span class="fl">119.77180</span>   <span class="fl">0.00000</span> <span class="fl">139.21565</span> <span class="fl">316.98819</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">66.57231</span> <span class="fl">340.39524</span>   <span class="fl">0.00000</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.939</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3019836</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.08333824</span></span></code></pre></div>
<p>The non-zero recruits have a scaled Log Normal distribution</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> rs <span class="sc">&lt;</span> <span class="dv">600</span>], <span class="at">breaks=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">600</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, </span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;Delta Log Normal&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>But there are many zero recruitment events</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fraction of zero recruitments</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>rs<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.39951</span></span></code></pre></div>
<p>Repeat for the case where R is the proportion of individuals in age class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.2, </span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="do">## where R is the proportion of individual in age class 3 as a</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="do">## fraction of individuals that are that age or older,  assuming</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="do">## recruitment occurs with probability 0.4</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsDLN</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.2</span>, <span class="at">p=</span><span class="fl">0.4</span>, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5928293</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileDLN</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>       p </span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="fl">51.71143</span> </span></code></pre></div>
<p>Random numbers of recruits are generated from the estimated parameters</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>]  <span class="fl">38.99461</span> <span class="fl">184.12007</span>   <span class="fl">0.00000</span> <span class="fl">202.50405</span> <span class="fl">319.14028</span> <span class="fl">170.32996</span>  <span class="fl">84.72592</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>]  <span class="fl">63.63437</span>   <span class="fl">0.00000</span>   <span class="fl">0.00000</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">100.1276</span></span></code></pre></div>
<p>Simulate the 10000 stochastic age profiles with this distribution of recruits and check the the observed mean and variance of <span class="math inline">\(R\)</span> are reproduced</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsDLN</span>(<span class="at">n=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms), <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3557747</span></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1149841</span></span></code></pre></div>
</div>
</div>
<div id="prrecruitsgym" class="section level2">
<h2>prRecruitsGYM</h2>
<p>Grym offers the same proprtional recruitment model based on the Beta distribution offered in the GYM.</p>
<p>Let <span class="math inline">\(A_{k}\)</span> be the number of individuals in age class <span class="math inline">\(k\)</span> and define <span class="math display">\[
R = \frac{A_{r}}{\sum_{k=r} A_{k}}
\]</span> the number of individuals in age class <span class="math inline">\(r\)</span> as a poportion of all individuals of that age or older. Given estimates of the mean and variance of <span class="math inline">\(R\)</span> from independent surveys, the proportional recruitment model determines the scaling of natural mortality M and the distribution of random recruits that will reproduce the observed mean and variance of R.</p>
<div id="setup-11" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="gym" class="section level4">
<h4>GYM</h4>
<p>Let <span class="math inline">\(R\)</span> be the proportion of the number of recruits as a fraction of the total population.</p>
<p>Generate model parameters from the mean and variance of R. This computes an estimate of the scaling of natural mortality required to reproduce the observed <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsGYM</span>(<span class="at">Msf=</span>Msf, <span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>)</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3263206</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileGYM</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">91.30353</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimate parameters</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">120.98173</span>  <span class="fl">90.55144</span> <span class="fl">119.53366</span> <span class="fl">109.83369</span> <span class="fl">113.60536</span>  <span class="fl">72.81516</span>  <span class="fl">71.29356</span></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">149.04361</span> <span class="fl">166.15930</span> <span class="fl">137.67248</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">99.40141</span></span></code></pre></div>
<p>Simulate the 1000 stochastic age profiles with this distributionof recruits and check the the observed mean and variance of R are reproduced</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">10000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">1</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3034161</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.0102989</span></span></code></pre></div>
<p>The random recruits have a scaled inverse Beta distribution</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Histogram of simulated recruitments</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">100000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>rs[rs <span class="sc">&lt;</span> <span class="dv">350</span>], <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">350</span>, <span class="at">by=</span><span class="dv">5</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">&quot;Recruits&quot;</span>, <span class="at">main=</span><span class="st">&quot;GYM&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAflBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6ZmY6ZrY6kNtmAABmADpmOgBmOjpmkLZmtrZmtttmtv+QOgCQkDqQkGaQ2/+2ZgC2kDq2/7a2///T09PbkDrbtmbbtpDb27bb2//b/9vb////tmb/25D//7b//9v///9PRD/5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQJElEQVR4nO2dDX+rthlHyW3irqu9da2zxdutt24hjr//FxySAOMYv0h/ARKc82tprm+EQD4V4hF6KI4AAsXUBwB5g0AggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUB3+M8vRVH88PN/qx93RbG2n1U/bM2meH6v/1i8THmMU4JAN/l8LRxP2+PxsCme3qoPP1bGHKON/WP1MQJBL60/RfHt+/G4t6JUHxpxjEC2R6p8QiDopaw6md+qy9S/V9YV49PWfGi8qQT6yV7D9gUCQS91X1Px8ZPxyF68/vdqeyMj0J9X1V9/vn77OwJBH9Xo5osYe9PtVL3Q0Qr022vVF32snv+JQNBH1eGszz+xgyIni7kV21XXsLJY7xEI+qgFKu0o2t2yl0VzVTMCldXVbFdsEQh6qS9hXYGqLqh2ZVeZVBn26+bprUQg6KMeRF8XyF7RzFUMgaCP5jb+84+/9gpUB6ERCPrpBBKLn5tPugKVNphYXckQCPo4TWX81n7QCvTtu1Gn0giB4Cp//LIqih/+9l7/8YtAn6+1RggEEAICgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgYSfQE22E5vnFsBToH2TtLT8mr0UloqPQJ+vrTb75/dbvwmLwUegw2bb/FhyEQMLPRBIeI6B6i6IMRDU+N2F2VdjtTmTAYgDgQYCgQQCgQQCgYRfHOiU+J84EFi8eqDPV7yBc3wnU5NL6V/3iFMfxmLxbPmy2N7/pcHpSlP8bkCgqciy5WtpHAg0KVm2fC1Ndzv1IS2WLFsegdIhyycSESgd4jyReIoPRTuwfs7GPQiUAJGfBxpcoEt1EGhSIj+RiEBLgx4IJCI/kYhASyPyE4mTCcSExkREbvPJBKIfmggEAonANt+ndheGQBNBDwQSCAQSCAQSkSdTEWhpRE7vgkBLYy5TGQg0EdlMpl59kAOBJiWbHuiOOm7LhMboZDOZ+pBA9EOjk81kKgKlSTZxIARKkzkKxEhoROYoEP3QiCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSPi1864oXuzasGvpxhFoafg9E/38Xjn0Yh5tTfmZaAQaEe9VGeXT2zHZVRkINDre68LcirAJ1oUhUJLQA4FE2Bios8RQ2J0XCJQmGdyFPbSoGYEmIoM4kLc6CDQi8xWI1WGjkEGCqUCB6IdGIYMEUwiUMhmkd0GglMkgwRQCpQw9EEhkkGAKgVImgwRTCJQy840DIdAoIBBIEEgEiTiBxEFf+41AKcNtPEjMPZDIlOrAzL0Hoh8amLkHEhFoYOYeSESggZl7HAiBBgaBQCKwbcd87TcCpQw9EEggEEggEEjMfTIVgQZm7qsyEGhgmMoAiaQnUwNXxSPQiCTdA0VQB4EGJunJVARKn6QnUxEofZKOAyFQ+iAQSCAQSCxDIJ6MHoxlCEQ/NBgIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBJ+rbr79v34sSoK+9pLfXf3QKD08WpV68+Pb2frM4Td3QWB0sdvWc+6kujF/JjZqgy35amgAfBdF1Yv7RlpXVhcgeiHBsDvElb1Pvt8eyAEGgCv9jxsvn3vvDxe3d1dECh9PNuzdOOIl0i7u0q0Rc0INDCJxoEGUQeBBgCBQCLRBFMIlAuJJphCoFxINL0LAuVCogmmECgX6IFAItEEUwiUC4kmmEKgXCAOBBIIBBJte1ZXp6szXC0EEuELnfbcV2ZcGRu3vzHWa78RKBfO2/O2Q9zGwwVf23N/4wI1j0AiD7ZG5awlzdM+5qnVK93LPHog+qGonFrSxHicFte6l3kEEhEoKp27sKuLvU7MIZCIQFE5CfQX58/V7sdvdyIIlAsXAl17H7Pn7kQQKBfqltydIjm3Q0E1Q7/2G4Fy4aIHirQ7dT8IlAnLmwtDoKggEEi4ljxs1s0d+vWJ0uM8JlMRKCrLW5WBQFFZ3jPRbsuMWCS6UxlrM5V6Ncg8l8lU+qGonNpw9/z+sXqpE0j1MqceCIEi0ZkL21ZDm+3NqYwZTaYiUCTOBDI5EG9OZcxnMhWBItG5hL0cNs/vh839J6Mf2l3oDgbMDIRAA3D2PNDT2+er5E8EgX4fRx0EikRqkWgEygwEAolTG96dpvDbXegOECgvOoNoyZyL3YXuAIHyonMb/9CTZI/uLngHCJQXZ3GgiLsL3gEC5UXbhuoN/JfdBe8AgfLi1IZlEaELQqCl0c3OwV0YeEMcCCSWLRCPlcl0Wq+6iD2/77Sb+cwEoh+S6Qyin972ZjZeMgiBlkbnNn5tnzOceGkzAmXGWSDRCDRxcgUEyoyLHmh346n6mo/V1YgRAi2Nr2Og/Y1wYhsquh4tQqClcX4XVhQ3s0zVz9LTA0GLX+uZp6bnJxDRIAHfdttVXdTcBKIfEvgyF3Z/BL0v1ggELU277dzgeX8/QdnH6gcEgoa63cpm8Hyjd2n4fL1+p4ZAS8O1W+dpshtr4x/enbIDBMqLNsFU88HNqYzhE0whUGY0At1N3GIYIcEUAmWGj0BjpHdBoMzwEWiMBFMIlBn0QAgk0Qh0d5rUMEKCKQTKDN+5sKETTCFQZiz7oXoEkkEgBJLwazcCifCFOJnq4732G4EyI7VM9QiUGT7tRiARLqAHQiAJzzHQjAOJPBkdBIFE+iGJdOJA3RT1CJQNCQnU+R4RKBsCW2yA134jUJbQAyGQBAIhkAQCIZBEOpOpCJQlcSZTw3b3pWgSAhFO9CSdqYw0BHLb8LNYHOlMpiJQltADIZBEOpOpCJQl6UymIlCWEAdCIAkEQiAJBEIgCQRCIAkE6tsSkH4YBLq6pSN6BARCIAkEQiAJBEIgCQRCIAkEQiAJBEIgCQRCIAkEQiAJBEIgCQRCIAkEQiAJv0baF0X9Yrp5P1SPQA/j90z009vxsDEvFEMgcPivyvh8fX5HIKgJWRe2e35fhkA8FXSfoHVhu5eoAnVzkyUlkNuGnNJy8BsD1docNtfSK4QJdPW7Q6Dk8b0Lcxexz1cEAksKcSAEyhgEQiCJFBJMIVDGpJBgKnGBuJm/RQrpXRIXyG1DTmwJpJBgCoEyhh7oQYG4kPWTQoKpLARy25DTmzcpJJhCoIwhDoRAEgiEQBIEEhFIIk4gUXvtNwJlDLfxCCRBINFLIKJBX6EH8hLIbUNOcq4QSEQgCQKJCCRBHAiBJBAIgSQCGyPush4Eyhd6IASSQKAAgYgGnZhWoMs1qVkI5LZxWy5Xpp1MDf3uECgZpl2VgUDZM+1UBgJlz7STqVkLxFDaQA8ULJDb+p3w/Jh2MnUGAi29H5p2MnUGArmt32nPiYnjQAiUOwiEQBIIhEASCIRAEggURaDl3oshUBSB3DZuW+YBAiGQBAIhkAQCRRRoiSMhBIookNvGbdHUQSAEkkAgBJJAoOgCLWskhEDRBXLbuO2aLlMJdG09xmwEWko/NJlAA353SQjktnFbN0UQCIEkploXhkAzYap1YQsRaP4joalWZSxEILf1aOPsmGpd2KIEmnM/RA802kHMU6Op1oUtUCC39WnvHJhqXRgCzQTiQCMfRJe4bT8NCDThQcRt+2kgkIhAEgQSJzyIOVzIxr+Nvz0PvyiB3DZvjcYPJKb03SV0EB7fQ1JM0AMl990lcRC59kPjBxLT++4SOohLfL6fKRg/kJjqd5fmQSRv0/hxoGy+uyQO4vxQEpRpTIEeuf9K6LtL4iCuH8qFRtOINWYgMbPvLomDuHcoXS4/GaHHihNIvH6YV88HkmIUgR64jYelETmQCEuDHggkIgcSYWlEDiTC0kglHgWZgkAgESjQtdd+w9KgBwIJBAIJBAKJyJOpl/uHLPAWp/2CfX75/qoMbf8xC09VdmkVDz2VkWGTZHrQGQgUMpmaYZNketAZCEQPRMVayYDJ1AybJNODzkGggMnUDJsk04POQqCR949A6VeMQJHLLq1iBIpcdmkVM5UBEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEoMKVBbF01tAOffc2kvAHj7+9P2sYp/yrmxI3Xa10zqs4rZs0EnvL+p7vHBTNry1DUMKVFZHU4YY9PHjW9geDhv7sH9bzKd8XTag7s/X6tf25ivwr/hUNuSkTYqC8/oeL9yWDW5ty4ACuWfwdy/+JZs1H757KN2Sx7aYT/m6bEjdHyvzqHj1hQRU3JYNqfiwWZvffwk547ZscGs7BhTo1Da+7F+C9lAWa9sYbTGP8k3Z0Lrt/78hFTdlgys2EoRWbAUKPmPLkALZrjEkHefuJzcu8N+DE6gp5lfe/V5w3btOfb6Fq7LBFe8r+UIrNmWF1jYMKJC7nAYMgg4bs+pjtw7Ygz39tphfeVs2uG6z0imwYls2sOLSfvdhFbuyQmsbUhSoLv7t+wQChdZdNmPokIqLdtwRcNKfr8/voeaassEVO5K8hLniq+0Ul7Cwut1Ky7CKu6s0Q07aDL5Cr52tLkGtbUhyEO2K//jmv4fgQfTxXCDPuuu0JUEV77urfENO2nz3oaN39/uBFVtSvI13Z1J2bosfpgy+jT+Tz7PuZsl3SMVN2ZCKL8v4xg/Kxrmg1jYkGUi0J7FbB+yhDA8kNndh/nV/rJo+xL/iU9mQk95VQxj7vQeccVs2vLUNg05l7AOnMo676sZyG7KH+jLUFvMpX5f1r3vvEgaYX/auuFM25KQvyzxeuC0b3NoGJlNBAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoFAAoF6scl3m9y9tzhstsdjuR3jmNIEgXqx2SdN7qdH1LASLRUE6qUWqP7PHRAIvtKYY5Lo2BQs9lq2txndD3/5R/HtX0aaypzqn49VUTy/m+1D/dXMQKBeuj2QzaNr8kCZHw6btU1rejgJZH+2eb4eu+LNCwTqpRbI5J+zKd1N9in3Q53j/atAwblEcweBemnuwrZNItM2k+XJnTOB6jdtLA8E6sX2QB+r+hU2zqXmpSS9AjnllncFQ6B+3CWsPGWBP55S4vYLZNiFJlXPGATqpR4D7eywudbjNAba1n+olDoTaIn38wjUSy2QveFybyQx79Op/q3+or5iPb9XV61aoPUpx+7SQKBemjiQTSNvwj/uVVAuDmT7GfOev1/dJey4K57fyyI0p3HeIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBI/B9gLR7hemLaOwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Repeat for the case where R is the proportion of individuals in age class 3 as a fraction of individuals of that age or older,</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01, </span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of individual in age class 3 as a fraction</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="do">## of individuals that are that age or older</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsGYM</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf, <span class="at">r=</span><span class="dv">3</span>)</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated natural mortality scaling</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>ps<span class="sc">$</span>M</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.2499531</span></span></code></pre></div>
<p>Compute the median number of recruits</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Median number of recruits</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsQuantileGYM</span>(<span class="at">q=</span><span class="fl">0.5</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">112.4347</span></span></code></pre></div>
<p>Random numbers of recruits are generated from the estimate parameters</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ten random recruit numbers</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">119.94286</span>  <span class="fl">56.67406</span> <span class="fl">116.42754</span>  <span class="fl">26.26030</span> <span class="fl">119.62612</span>  <span class="fl">83.60271</span>  <span class="fl">84.35692</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">213.81809</span> <span class="fl">185.03301</span>  <span class="fl">62.08191</span></span></code></pre></div>
<p>Check the random numbers of recruits have the required mean</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean number of recruits</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>))</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">122.8426</span></span></code></pre></div>
<p>Simulate the 1000 stochastic age profiles with this distributionof recruits and check the the observed mean and variance of R are reproduced</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate age profiles and calculate R</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">100000</span>, <span class="at">ncol=</span><span class="fu">ncol</span>(<span class="at">x=</span>Ms))</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(<span class="at">x=</span>N))</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  N[k, ] <span class="ot">&lt;-</span> <span class="fu">ageStructureS</span>(<span class="at">R=</span><span class="fu">prRecruitsGYM</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">ps=</span>ps, <span class="at">mnA=</span><span class="dv">100</span>), <span class="at">Msf=</span>Msf, <span class="at">M=</span>ps<span class="sc">$</span>M)</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> N[, <span class="dv">3</span>]<span class="sc">/</span><span class="fu">rowSums</span>(<span class="at">x=</span>N[, <span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate mean and variance of R</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x=</span>R)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3051148</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(<span class="at">x=</span>R)</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01042226</span></span></code></pre></div>
</div>
</div>
<div id="prbootstrap" class="section level2">
<h2>prBootstrap</h2>
<p>Let <span class="math inline">\(A_{k}\)</span> be the number of individuals in age class <span class="math inline">\(k\)</span> and define <span class="math display">\[
R = \frac{A_{r}}{\sum_{k=r} A_{k}}
\]</span> the number of individuals in age class <span class="math inline">\(r\)</span> as a poportion of all individuals of that age or older.</p>
<p>The proportional1 recruitment model assumes estimates of the mean and variance of <span class="math inline">\(R\)</span> from independent surveys. To allow for uncertainty in these estimates, <code>prBootstrap</code> uses parametric bootstrap to simulates new values for the mean and variance of <span class="math inline">\(R\)</span> that are consistent with the observed values.</p>
<div id="setup-12" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Create matrices of age, length and weight for each time step and age class</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ages</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="at">X=</span>Days, <span class="at">Y=</span>Ages, <span class="at">FUN=</span><span class="st">&quot;+&quot;</span>)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Age-length and length-weight conversions</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>ls <span class="ot">&lt;-</span> <span class="fu">vonBertalanffyAL</span>(<span class="at">A=</span>ages, <span class="at">t0=</span><span class="fl">0.0667</span>, <span class="at">K=</span><span class="fl">0.5</span>, <span class="at">Linf=</span><span class="dv">500</span>)</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">powerLW</span>(<span class="at">L=</span>ls, <span class="at">a=</span><span class="fl">9E-10</span>, <span class="at">b=</span><span class="fl">3.32</span>)</span></code></pre></div>
<p>Define the intra-annual natural mortality, its integral and the annual scaling</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>Msf <span class="ot">&lt;-</span> <span class="fu">final</span>(<span class="at">P=</span>Ms)</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="inverse-beta-1" class="section level4">
<h4>Inverse Beta</h4>
<p>Generate model parameters from the observed mean and variance of R assuming the Inverse Beta model</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsIB</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent projections could be based, assuming the original estimates were generated from 17 independent survey</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsIB, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3203361</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01070525</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the simulated mean and variance</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>, <span class="at">expr=</span><span class="fu">unlist</span>(<span class="at">x=</span><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsIB, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAeFBMVEUAAAAAADoAAGYAOjoAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmZgBmkJBmtrZmtv+QOgCQOjqQZgCQkGaQtpCQ2/+2ZgC225C2/7a2/9u2///T09PbkDrb/9vb////AAD/tmb/25D//7b//9v///80wcMzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATYUlEQVR4nO2d6WLjuBEGZe/E3t3x5hjnsJKMlRlZ5vu/YXjrpAjyA8AGWPVnJS3YA7RLIAmSrU0BILBZugOQNggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEskI9HPpDiyG7ZEjkHlsjxyBzGN75AhkHtsjRyDz2B45Avnk83VT8/jdY1DbI0cgj+w2X5sX++6FD2yPHIH88fnaa7P78sNbWNsjRyB/HF6+dS/3HnditkeOQP5gBrKM7TQ27DbtFMQxkDk2P6uzm6V7McbhpTkL8zT/1LEQyAubn+/v76l01hebeswI5AMEMkoqf5OUBPp4/jbeyAUE8kcKAnVHQH7WoqsoCOSNFATqTr78zEClPQjkjyQEKueg6vzrWqDjzOQeC4G8koZARbF9eLs3AyHQUqQiUHVBFYEMkoxA5fzzCwLZIx2BqpuCEMgcCQl0DwRaCgQySip/EwQyit2/yfm6SQoCOaxEI1A8quy9JyVQefg8dgUDgeKRoEClQU/3GyBQPFIUqNgPn8HXIFA8khRoDASKx1Gg+qgUgWxi929yIlD1AoFsYvdvgkAIJLFmgTbN7YgIpLBqgd5rexBI4ZZAE2/qswcCxeOWQO+pT0MIFA8EQiAJBEIgCQRCIAkEQiAJBEIgCQRCIAkEQiCJQYFSXkxEoHgMCpTyLDRD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" /><!-- --></p>
</div>
<div id="gamma-1" class="section level4">
<h4>Gamma</h4>
<p>Generate model parameters from the observed mean and variance of R assuming the Gamma model</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsG</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent projections could be based, assuming the original estimates were generated from 17 independent survey</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsG, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3819306</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.00968227</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the simulated mean and variance</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>, <span class="at">expr=</span><span class="fu">unlist</span>(<span class="at">x=</span><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsG, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="log-normal-1" class="section level4">
<h4>Log Normal</h4>
<p>Generate model parameters from the observed mean and variance of R assuming the log Normal model</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsLN</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent projections could be based, assuming the original estimates were generated from 17 independent survey</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsLN, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3113698</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01004725</span></span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the simulated mean and variance</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>, <span class="at">expr=</span><span class="fu">unlist</span>(<span class="at">x=</span><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsLN, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAdVBMVEUAAAAAADoAAGYAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmZgBmkJBmtrZmtv+QOgCQOjqQZgCQkGaQtpCQ2/+2ZgC225C2/7a2/9u2///T09PbkDrb/9vb////AAD/tmb/25D//7b//9v///9zZ8UVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATKklEQVR4nO2di5biuBFA6Zn0ZLNsHkMeTZKBzNLg///EYMs2GLAsu/QoyfeePTuNj1VIxUW2hC1vKgABm9QVgLxBIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBfHLZbRq+/Ehdk2ggkEeOm1/NH6fuj/JBIH9cdr02x68/U9YkIgjkj/P2e/fnaTUHMQTyBz0QyDhu2i6IcyBYxHlrRmGr6X8QCIQgEIhAIH+ct/WZz4mJRI38nroCDjQCNeOvuwG9B1S3HYH8UQvUquN1GK+67Qjkj1qgz2+NQA8TiZueJXFVtx2B/OHQAyFQKlQnscXMAr1X3en0CxAoFaqTeOPq0NuHZSIagVKhOonuIFAqVCfRHQRKheokuoNAqVCdRHcQKBWqk9jS/RZvuSoageJym31TncSOy27qR7D56b42X3XblQt0qMlGoKtB7/YdFgh0OKhuOwJ55bSx/4o6I91t14tAErITaIo5ApmGI5AEBEIgEQiEQCIQCIFEIBACiUAgBBKBQAgkAoEQSAQCIZAIBEIgEQiEQCIQCIFEIBACiUAgBBLxKNDyuzuVgEBxuRPIuNO9zBUEisu9QM1fCKQN3Z8GAiGQCARCIBEIhEAiEAiBRCAQAolAIAQSsVqBzJwXAklZr0BNWxFICgIhkAgEQiARCIRAItYukDmXRqDFrF0g02QEWgwCNQJpvgZKb81qEKgRSHOb9dasBoGGAim8HlNbfYa0AtXrBCJQ1f+8oQlt9RnSCnSozwMQCIFmg0AIJAKBOoHM2Q8CzQSBOoFMuxFoJgiEQCIQCIFEIBACiUCgwgS67KzPovEOApUl0LF7Fuj4Q0H9gkBFCXTZ9dqMPdbaMwhUlEDtM9FrTnEOYghUlED0QGJc6t5eh1igQNdzoLYL4hxoIU4CHTp7ihOofyponP4HgYoTKDYIhEAiEKgogc7b+sznlHwiMeOlNhHIjL/uBvRBeS3QId9+CIFadZIO4xFIEXMF+vzWCPQwkbjp8Vo5BCpPoIkeCIHsrF2guo95r7rTaWE4BxCoKIGqxqG3D8tEtL/m3VamR6CCBIoX7t4VBEKg+ZEQCIFEkRAIgUSREKg4gbrf4i1XRSOQnXULVF12Uz+CIZCdlQt0NejdZzhrJAQqUKDqtLH/iopAdkQC9avXa4KT6KiIBDL/Ba/jPBAoKggULRwCIZAsEgIhkCgSAiGQKBICIdDSIP2VHAiEQEuCPLqSjUCTy98gUIxw2Qo0vfwNAsUIl6tADotPIFCMcLkK5LD8DQLFCJerQPRASsLlKpDD8jcIFCNctgJNL3+DQDHC5SvQJAgUIxwCIZAsSLYCMZGoIly2AjGRqCNcrgIxjFcSLleBxicSZy1/g0DiIJkKRA+kJFyuAjGRqCRctgIxkagjXL4CTYJAMcIhEALJgiAQAomCIBACiYJkKpCn5W8QSBwkU4E8LX+DQOIgTgJpfGCGl+VvEEgcxEkgld2Qj+VvEEgcJF+BpkCgGOEQCIFkQRAIgURBEChDgc7bzcQIYlY4URCNAsXLT6YC1RcjbMRP8y5XoHj5yVagykOOShaoipSfnAUyKRI8UrdwgaLkJ2OB6gcyf68uu+UPRC1boDj5yVWg+qdAk5mxpSVmhROgU6Bo+clUoPP27cNjOFEQjQLFy0+mAikKp1IgP0xWuF0dMkuB9tcOevxpqLPDCYLoFChKfjYDWbISaN8c4M9b0XRZwQLFyU++AnW3VQrOEKuSBYqUn3wF6m6rPCLQSyLlJ1+B2tsqP78xE/2aOPnJWKBrbq4jAOFYtWCB4uQnZ4HUhFMqkA8QKEY4BMpSoMnl2Vz2KVggl/xMUrJA++nM+FnCbbpOKgVyyM80BQt03k4OLzwtoDRdJ40COeTHgaIFst/RVHl7FoS1OsNHhakSaDI/DhQs0ORNlaF7oFfuKBLIIT8OFCzQ5E2Vla8l3MZq8sIdRQK55GeaggXql5awnSt6WcJtrKhugZzyM0nBAiUPp1wgPyBQuHAI1OyQsUDXTvrrz711sBpyIlG9QA75maRkgU5vH9exlXW6I+hE4iKBIi4S5JCfafwIpGllpMH1QPXg3HK9S+Bh/BKB4nVDDvlxwJNAijqiwURinSDLFXeengUxVhPdAjnkx4GCBeq+Yfvxu+bogez5caBggdpj/NE2XaZvIjHimbRDfqYpWSAzVWa/4k7dRGJEgVzyM0nRAiUOp14gHyBQuHAI1OyQrUCRfuuxFNUtUIz8mMsRJgRqdxJUwiuPFZGNUgsWqCVofgbajAl06DsiFTxVZD9+2YunZ0GM1SQLgWz5cWAFAtm+Yn6eBTFWNA+BQk4kFiGQdarey7MgxormIVDInzJKEGhi9Qkfz4IYK5qFQEFX58haoMk5wnnhFhTVLVCM/GQtUPJwygXyAwKFC4dAeQvkMEafE25BUd0CxchP1gK158ehf222FNUtUIz8ZC3QZWcyM3alz8xwC4rqFihGfrIW6PybuVAh2RqJygWKkZ+sBeq+YYGvuLMU1S1QjPxkLVB9xd31/0fZFVPlChQjP3kLZMYZsnmykgUKnJ/uMo2MBUocTr1APrAI9KQIAs0sikCZCxTl1l1LUe0Chc1P/gLFuXXXUlS5QIHzk71AkW7dtRTVLVDo/GQvUKRbdy1FdQsUOj9zBdKyvsJTD5ThRGKUJTpC52euQFo6ocdzoBx/TI3TDQXOT/4Cxbl111JUuUCB81OAQInDqRfIBwULdLd2i49wC4rqFih0frIXKNJK7JaiugUKnZ/sBZLetPsYbn5R3QKFzk/2AmW8uEKkHihsfrIXKHk45QL5AYHChUOgjAXyc4ZYFStQhPwUIJCPgWrJAoXNDwLdhVtWFIEQCIEmQCCncMuKIhACIdAEvgVKf1kQArngmh/B47AWCpS8I+oE8rH0RFWwQE75kTwOK2+BNITTLJAboofRIJA0XP4CjT8OqweBwoXLXyB6oKTh8hdI9DgsBJKGK0AgyeOwEEgargSBJvEqkIrHriBQDByeKbtAoEPfESUEgfxh7ps/RZtIRKBh0TIEasZfo9cPIVC4cGUI1KoTZRiPQMOiRQj0+a0RKMpEIgINixYhED1QgnDtAKUAgepmvFfd6fQLEChEuNdG5CdQ1Tj09jE+EY1AQcIVJNAUCBQiHAJVCCQJh0AVAknCeREoyjp3YhAoRDgvAuXRDSFQiHAIVCGQJBwCVWsRSHDbiq0OCLQSgSS3rdjqgEDrEEh00bitDgi0DoFEt63Y6oBAEoHSTl/QA0UlhEBp2z3zHGj5bSu2OiDQSgSS3LZiqwMCrUWgMOEQqFq7QA63rdhKI9A6BBLdtmKrw+oFai/IXIVAS29bsdUBgayKFCXQ4ovGbXVAoPUItPi2FVsdEGg9AtEDiVi7QILbVmx1QKB1CFRJblux1QGBViNQkHAIhECicAiEQKJwCIRAonAIhECicAiEQKJwCIRAonAIhEBLw91WBkIgBFoQbsoIBHIVKNW19QgUlYACJWp+WQKpX6MDgTyH8yzQQXs/hECewyFQdz0rAi0Kh0Bd94NAi8IhkBeBEj63B4GiEkigQ98RRQeBohJWoBQj0BIFUjyWDytQii9PiQIp7oYQyHM4BEIgUTgEQiBROARCoKXhHp7xhEAINC/cPCMQCIEed0WgdhsCLQqHQN02BFoUDoG6bQi0KBwCddsQaFE4BOq2+Rco4m85CBSVWALFSwACRQWB/IVDoG4bAi0Kh0DdNgRaFA6Bum0ItCgcAnXbEGhROATqtvkUyAzgEQiBFgpkmo5ACIRAk7siULsNgRaFQ6BuGwItCodA3TYEmhvu4WpWBEKgeeEsnzsCIZDDXgh0vw2B5oaLIZDO+5sRyEu4GALp7IYGNWoVDyRQpC8QAkVlKNDhEFCgSO1HoKggkJdwCGReINDCcAhkXhz6xem8CnRbtDN2i2KFiybQDb/NXMyTQC5izBXovi+K26JY4aIJpK4vQiAv4RDIvECg+eFe/QyGQAjkHG7m545ACPSwAwLdXgQXKMLoYS0CKRmLRRYowjdnLQIddPRDKQQK+9VBoKgkEShoy+MJtBkdgCEQAjmEE3zuCIRACGSSMHgRVaDu6iPPJ0TrEij5UCylQIcgzxWbF+yyM5/Blx/zw2kQ6HAI2w3Ny098gfpt/pgV7Lj51fxx6v6YEW4FArnmZ9MPKMILZMYtw3cb74bn99Bzdr/s+rQcv/60hLubtru7oqJ4gdzzM08CkUAjf400YX7/NGf38/Z79+dp2Ek/XHez8c/v/kLNS5CC/HhsuwvzGu25BwrG73HfbhGh8qO67TPPgdqv2OgxPhiqk9gRKD+q2z6vwzpvTS8Xu/9RnsSeMPlR3fb0c2tuqE5iYFS3HYH0o7rtCKQf1W1HIP2objsC6Ud12xFIP6rbjkD6Ud12BNKP6rYnEWjBDzTLfg9K0TgZ/touYU6Fg6XC85vGKpOY6bsSIoRAIEGZxCBQqDdFIMcdEChtmcQgUKg3RSDHHRAobZnEIFCoN0Ugxx0QKG2ZxCBQqDdFIMcd1iAQlAMCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhERBLotNm8fbR/N0uZ1gswmdV03l3KVMfuxWCrW5mJ90nIoLqnxyY61ft1iKr6/OWHY4iXEVw/pEgCna6VOrW1vOyufxzrKn3+cdyEYZnq+OWHeTHY6ljG/j4JGVS3f9H/4VLv1yHqz71ZpdEhxMsIrh9SJIHM4oF7o/Hnt3oduObTHV1O+bHMeftrveV9uNWxjP19EjKobv/ittWh3q9DNB1JU3g6xOsIjh9SFUmgW3V6as2Ptq71uUwtw4tIk2Xs75OQQXX7F7etDvV+HaJeo9F88NMhRiI0TH5IVSyBmm5w4PL++mL/p/Y461bmeG3Oi0iTZezvk5BBdfsXt60O9X4dour/mQ4xHsHhQ6oiCWQOsfenLvUypudtvRblfqRyj2VOTTOeI02Xsb9PQgbV7V/0f7jU+3WI5kVtgUOI8QgOH1KVSqDT7bR+rDd5VuWy+/pznkCmjP19EjIhULuTtd4TAjmEsESY/pCqRIew+2WUzWF3ukzVNGzuIez2QYy9T0KmDmFmJ2u9pw5h0yFGI7h8SFWak+jj/TF1bJj44nT5umnuSfSt6QrH8lMn0WYna73HT4HvBbKFGIvg9CFVKYbx/XruprZjvcmLof911xnD+L6M/X0SMjGMd6n32DC+LecQYiSC24dUpZhI/PzWqd3UevT8bDDBtb+eyjStmzGR2Jexv09CJiYSXeo9NpHYjcKmQ7yM4PohRfspo/1VoZ6WOZpFsJoMXf8dPzzflbnb9Wj9KeN1Gfv7JGRQ3b5l/R8u9X4dou80HEK8iuD8IfFjKshAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCBCjUCXXbueyGnTrQll2bVB4XIJXrns2kUxzG3rd5y3rrf6B8+VJoGMOHsHgZp8nnQumOCRroWClgbPlSKB/vBbs7r2n//iKNDT97I4zlvTwv1URsYJnitFAr03q9Ccvv6jTtex63bb1UXO279tu2VGumwI8poJ+y9muflm2ac2Eb/9c/PlP80h7Ck1x3ZN+ePtmBU8V5oEOpkFQeu2HrtFjprVsq4vztt6zWKz+M1qeqBufbButSmTiGt6mnOgp9SYF7/ekletrAeqH+9w/u3jKpD5zp2+/DjXh7U6jc2WdsHDNhvH4s+BuoWyamUGiagFekqNSVrXYbULTAXPlSaBLrvv1yPYz323mm/ry6nun5vvXDv46EYWxftj1rvs1wl9SsRwS7ffIHnBc6VJoHpZ/et5UC3Qpmv29XD+5d/fHgWqHwLyrfgDWGVabFZQfU7E45ZuKdVb8qoIuVIl0Ocv//37R9X3QFX7Pfp8JdBgHeNy2X/9X9Pa50Q8bRn2QC3Bc6VKoMvur9fToOYcqOu162/f6ekQ1nyh9pbFNovh9Pav2+Lfg0Q8bbmdA90dr4LnSpVA14HpuzlnNA9Jefsw37DmmQ1PApnHOBTOZfenppXPiXjecmwe9PXeJ8+UD5wrXQI1E6b7bh7ILJi+efvY108eeRJouJh6qXSNfE7Eyy39PNDDryDBcqVGIMgTBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUDE/wHociVj6deFGwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="gym-1" class="section level4">
<h4>GYM</h4>
<p>Generate model parameters from the observed mean and variance of R assuming the model implemented in the GYM</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute model parameters that give mean R = 0.3 and var R = 0.01,</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="do">## when R is the proportion of recruits in the population</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">prRecruitParsGYM</span>(<span class="at">mnR=</span><span class="fl">0.3</span>, <span class="at">vrR=</span><span class="fl">0.01</span>, <span class="at">Msf=</span>Msf)</span></code></pre></div>
<p>Simulate a new values for the mean and variance on which subsequent projections could be based, assuming the original estimates were generated from 17 independent survey</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate new mean and variance for 17 surveys</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsGYM, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>mnR</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.3238029</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>vrR</span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.01482802</span></span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>p</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">17</span></span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>r</span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1</span></span></code></pre></div>
<p>Generate 2000 bootstrap samples and examine the distribution of the simulated mean and variance</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution of 2000 samples</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">2000</span>,<span class="at">expr=</span><span class="fu">unlist</span>(<span class="fu">prBootstrap</span>(<span class="at">prRec=</span>prRecruitsGYM, <span class="at">ps=</span>ps, <span class="at">n=</span><span class="dv">17</span>, <span class="at">Msf=</span>Msf)))</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Mean R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">1</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,], <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">median</span>(<span class="at">x=</span>bs[<span class="dv">2</span>,]), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAHgCAMAAAB6sCJ3AAAAdVBMVEUAAAAAADoAAGYAOpAAZmYAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmAGZmZgBmkJBmtrZmtv+QOgCQOjqQZgCQkGaQtpCQ2/+2ZgC225C2/7a2/9u2///T09PbkDrb/9vb////AAD/tmb/25D//7b//9v///9zZ8UVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATQ0lEQVR4nO2diZbbuBEAOXZmsrE2hyfHKIml2BpJ//+J4S1CPMEGCDRY9fatJQjoJ/SUQBIkwewOICAL/QVANwgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCCQS27vWcmXH6G/yWYgkEPO2bfqxaV5kT5xCvQr9BdYxe291eb89aeLiArygEDuuB6+Ny8vbjZiCvKAQO5gBIoGBYkb4pzVQ5CrfSAFeUAgl1wP1VGYm/FHRR4QKGYU5AGBYkZBHhDIHddDsedzcTiRqCAPCOSOUqDy+KtzQC9CQR4QyB2FQLU6HMaHRUHiBigE+nwrBXqaSMxa7CIqyEOkAq1IdngWjEBL+1R3H4FW8is7nU5xfrUJqlmg13uzOz3AYoGq7iPQSnQKdC8devmYmIhGoG1QK9AcCLQNCIRAIhAIgUQgEAKJ0ClQcy5+4qpoBNoGnQLdb+9zJ8EQaBuUCpQb9DpdAYG2QatA90s2fRYVgbZBrUBzINA2IBACiUAgBBKBQAgkAoEQSAQCIdB6sixDIARaT548BEKg9SAQAolAIAQSgUAIJAKBEEgEAiGQCARCIBEIhEAiEChdgTZZBxmBkhVom3WQEShVgdyvQjoIAqUqkPt1kAdBoFQFYgQSs2+B3K+DPAgCJSuQ83WQB0GgdAXaBARCIBEIlKpA7tdBHgSBkhbI6TrIgyBQygK5XQd5EARKWSC36yAPfyUESlggR+sgT34lBEpWIGfrIE9+JQRKVKC7u3WQp0CghAXaIhwCIZAsBgIhkCgGAiGQdbvOFAACpSqQw3WQe+06wiBQqgI5XAe51w6BzHpl97Nf8efA9q4MR+sg99rVwpSjGwIlK5CzdZB77RqBin8RKF2BfIVDoKd6CGTZDoHMeghk2Q6BzHoIZNkOgcx6CGTZDoHMeghk2Q6BzHoIZNkOgcx6CGTZDoHMeghk2W5MIFcXWkcCAnkKNy5QWkMRAnkKh0BP9RDIsh0CmfUQyLIdApn1EMiyHQKZ9RDIsh0CdWtlCGTbDoG6tU4IZNuu8KS6GhGBEGhFu0qcEwKVtRDIuh0CdWshkHU7BOrWQiDrdgjUrYVA1u0QqFsLgazbIVC3FgJZt0Ogbi0Esm6HQN1aCGTdblKgdC4qQyBP4aYFSmcUQiBP4RDIqIVA1u0QqFsLgazbDQnUObu6W4Gi3/uLWaBTt9Dp1/TF7FOtrQWKvucI5JD5p1ojkKdwSQi04JmyCOQpXBICLXiqNQJ5CpeEQI5HoBwEWtwuBYEWPNXaRqD8PwRa3C4Jgeafar1KoKiP5RFoU9YJFHP3EWhTprvRDDUIZN8uDYGEE4mNKQhk3y4JgaQTiQi0b4HEh/EItG+BxicSFz7VGoH2LRAjULhwSQgknkgcFihDoAXtkhBIOpE4LNAJgRa0S0OgWRDIUzgEKj9FIASaBoE8hUOg8lME2rVA4qdaI9C+BRI/1RqBdi6Q9KnWqgXKx9+ZzluFs203K1Doq6qW5Uf2VGvVAhXzqNnYBOqacHbtZgUKPwr5z49yge4OcpSyQHfv+dEvUJWiuT1Bi3CL2+kQyHN+1At0ybPzPd8THD2V4+jW3YF2KgSazc8sKQtUzGJUmRm7K87ZrbsD7eIXaEF+5klYoOvh5WOmrrMb5wbaRS/QgvwsYLVA0d7ZY/O1nN26O9AueoHcsFqgaHvf+VrHfFQZ3TYVeBqBjGWAIhZoNj8LWCBQmQ2NAh1LJ66HiekyV7fuPrV59iROgRbkZ54lAnWc0SRQs32a3EN0dOvuUxsVAi3KzywJC9Rsn84eEzTSRoVAW+RHtUD19unzbfOZaB0CbZEf3QLluck3TtPHql4mEpUItCQ/syQt0Dx+JhK1COSCfQvk6zAegZpPVQs0u3mS37o78hV0CDSfnwWkLNBxNjP7HoHm87OAhAW6HuYPL/Y8kbgkP/MkLdD0xZh1pd1PJMpIWKDZ68Htwtm0USHQFvlRLdDs9eCW4RbW759IjVSgLfJTaJJpFai9K27TUxkD8kQq0Bb5eeiiUKAw4fQI5IZ9CyS+dXegPgJ1P9UtUO7H15/HqYNV6a27A/UVCTSfn3lSFujy8nH++nN6ukN46+5AfT0CLcnPLAkLVEwzF/PL09e7yG7dHaivRqBl+ZkjYYGKibIiQT6vuBuor0agLfKjWqDmF3Zcf9fcPWWBtsiPaoHqbfxZNl2WrkBb5Ee3QNVRutcr7gbq6xFog/woFyhEOE0CuQCBHIdDIONTzQJxLmyaCM6FRXmD/PM3kh2lJixQjdf8zAkURwpMet/o6PHW3YH62gTymp8kBIp5IjGGMTzgRKIOgba9tdlOoBhGoYCnMlQI5HX1iYH62gTyvjqHWoFmr5e3C7e0vhqBvOcn617NqlCgMOH0COSGKYFOJwRCoBkkAsX56Mv+RKJorixdgbznZ1agU9wC1deKRX02PugI5Ds/2gW6vVeZGbvr3TLc0vpqBPKeH+0CXX+vLlSIeSIx6CbMd360C9T8wmK+IjGGEchbfrQLVFxxl///LLtiKl2BvOdHvUDVcYZsnixlgXznR79AIcJpEsgFCOQ4HAI9PlIvkP9bdwfqKxLIc37UC7TBrbsD9fUI5Ds/2gXa4tbdgfpqBPKeH+0Cabi1OehEou/8aBdIw63NMYxATCSaPO8DcTJ1DN/5US+Qglubgx+F+cyPfoFChNMkkAvEAoW/LeUJYx/IYbil9dUI5D0/ywSK7hdkHIU5DLe0vhqBvOdHu0DSm3afwy2sr0Yg7/nRLpCGxRXCjkCe86NdoDDh9AjkBgRyHA6BHh9pFsjNHuI9WYG2yI9+gVwcqKYskOf8INAjnEV9BGo/QqA7As2BQIvCWdRHoPYjBLrbCTTytEIEQqCFdYfl2aFA5dJ9ygVysfTEPWGBvOanMEO3QEHCKRLIGQjkMFyCAt3eZ0YpBHIYbp1AMSz1O8Y5q/eSLtnI7hICuQmXTRyBzQgU8SjU2cseW0XIgUCR/YACCTTqhmaBOmfMxi4eciBQZP1HIHdsMwJF1n8Eckh7z4/PfaDI+o9ALpldjXxcoAyBLMKlKtAs4wL1NUGgiWo7E+gxjz38MQJZhktToGrpl8u6iUQEsgmXsEDl8dfoJbCuBIpnMgiB3FEIVKtjfxhvKVA0SUAgdxQCfb6VAtlPJCKQTbh0BWIEmmTl2eZ+tUQFKnLzem92pwfYuUBrzzb3qyUp0L106OVjPD07F2j1uZ5+tVQFmmPfAq0+29yvhkBG6U4EYgQS40ag4sRZLEmw3Adad7a5Xw2BjFJLgcp/N/7mY9h9j5Vnm/vVEMgo3Y1ArsIhkFm6e4Fmzjb36yOQUboTgVafbe5XQyCjdE8CrTnb3K+GQEbpjgRada6nXw2BjNIdCbTqbHO/GgIZpTsSiBFIxN4FWnm2uV8NgYzSnQh0X3u2uV8NgYzS/QjkKJxQoNjuD18OArkJJxRI7yiEQG7CIZBZikCW4RDILEUgy3AIZJYikEW4Zm0pBHqUIpBFuHk3EGipQBEcjiLQprgWKHwiEGhTEEgeDoH6pQhkEQ6B+qUIZBEOgfqlCGQRDoH6pQhkEQ6B+qUIZBEOgfqlCGQRDoH6pQhkEQ6BnssyBLIJh0DPZScEsgmHQM9l6wRqHpO5eR+evv3m4RDouWydQKcTAiFQWYZAVuEQ6LkMgazCORIogkthVoBA8nCOBNI5CiGQPBwCPZchkFU4BDIKygUzVwqUVf8LmgcE2pS+QINmLBSoeROiJ20HNg+HQEYBAtmGQyCjAIFswjX3hCFQW4BANuG6f34HAumbDEIgWTjHAp3UDUMIJAuHQL0CBLIJh0C9AgSyCYdAvQIEsgmHQL0CJwIFPJhAoE3xJVC4PCDQpiDQ+nDdSUQEagtcCJTtQ6Denx6BHAl0Sl6g59EHgdoCBFoSbvhPj0AItDAcAtUg0LpwCFSDQOvCIVCNR4ECzSUi0KZ4FChQKhBoU/wKFGIMQqBN8StQiGToF0jVVYkItC6cT4FUjUIItC4cAtX4F2jr8RiBNmUDgTbOBgJtCgKtC4dANQi0LhwC1SDQunAIVGN+06y7wi8CTYTzLZCauaAngebMQKCm2LNAakYhBFoXDoFqEGhdOASqQaB14RCoBoHWhUOgmvZbtk8qcCtQueJimB55DYdANQ+BTicfAtXDUIgeeQ2HQDWGQBkCLQk3dE8YAi0zA4Huw6MPAvkUqJxV3WpqNR2BGtx2yDGbCHTa8mgsHYFUjEQItDxcMxwgUIe9C3R7rzYTX37Mh2u3KzsSaHl+PAtUzweNbNFdbumtAp2zb9WLS/NiIpz9n169QEvzY1zG4UWg8t9yGKpd6ewiTi0nZK+WTfXbe5uW89efE+GyqZHHt0BTO9N+97KX52fy7+5WoNPj+c71m0fhwPez/gXaVL8evjcvL+YgnZl/tkzKL3GECewSFDQ/XvMwhl2nHY9AjvjlM7g33OdHQR4s94Hqn9joNt4RChI3hPP8KMiD3YB1PVSjnN/xR0XiBnGdHwV5iHPaREHiNkFBHhAoZhTkAYFiRkEeEChmFOQBgWJGQR4QKGYU5AGBYkZBHhAoZhTkYTuBbE7HOD8HtFkvV7FdHtwnaEOBwlWMdJxtGf964T+ZA4EiILwmCOSqZhDCa4JArmoGIbwmCOSqZhDCa4JArmoGIbwmCOSqZhDCa4JArmoGIbwmCOSqZhDCa6JBIEgSBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiPAp0CXLXj7q1+X6pcWqS9USOq/yiPdz/UYUMQBGJ9o3l5W9GYzWZtv82AceBbrk3/xSf/vbe/7iXOTl84/r+9ONeD9/+VG9kUQMgNGJ9k37wrI3g9Ee2TY+9oI/gaoVA4/Vb+nzrVj8rfybj66hbBfxevhWlLz2FrSMHKMT7ZtHqV1vhqO12TY+9oM/gR7OtBS/hfP63vQjlgIJIgbA6ET75lFq15vhaNVnebYH/gau8ShQORYbP6hj/ub4p2bz7CDiuRidBREDYHSiffMotevNcLTqs2M3rDf8CVRtersb4GLt0uuhWIDyuOrv/RzxUmZaEjEARifaN+0Ly94MR6s+ypPT/xs4Z0OBLo9ji3W/iX46bu/NeqhqdoRmBKorLe3NuECXZh9arUDPw2d37eRq2yyNeO/kZl3EAMxtwqpKS3szugmrsq16E/a0A3fubtjXHXkP7BK2mVZzLD+3E11VWtqbsZ3oOtuqd6LNQ8hmEfeqS+t+EwMTA5cm92o2YTOH8Za9GY7WZlv1YbwxifX51ow/ZW9W7vIa02LHfPenTJAkYgBmJhItezMY7ZFtzROJ7bmGYrLmXK2DVWYo/3ft/konYieQJGIAjE4052MeLyx7MxStk+2z4lMZsAcQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIAKBQAQCgQgEAhEIBCIQCEQgEIiIRqDbe73+yyVrFo2aqFqiZj2Fldze60U6qhvfO1wPS++e956rmASqxDkuEKjM50XTigqraHoo6Kn3XEUk0B9+Lxfa/vNfFgrU+10mx/VQ9fA4l5FxvOcqIoFey1VxLl//UaTr3Ay79Won18PfDlm7bJI4r0o4ltuwcknsNhG//zP78p9yE9ZLzble4/782GZ5z1VMAl2qBUqLvp6bZZLK9bbyN9dDscZ0tdTNbkagZr2yZuGpKhF5esp9oF5qqjffHsm772wE+vztR/4D+8gFqn5zly8/rsVmrUhjWVKviFhn45z8PlCzklahjJGIQqBeaqqkNQNWvUqe91zFJNDt/Xu+BfuZ56tala325VKMz+Vvrj74aI4skvenWh+zXUi0lwizpKlnJM97rmISqFjmP98PKgTKmm7nm/Mv/357Fqh4aMtb8huwe9XjapHVfiKeS5qlXR/Ju2+Qq6gE+vztv3//uLcj0L3+HX0OCWSsO50ux6//K3vbT0SvxByBarznKiqBbu9/zXeDyn2gZtQufn2X3ias/EEd/a4eGQeXl389Fgs3EtEreewDdbZX3nMVlUD5gelrtc9YPUWletzM9VA+Y6MnUPVYicS5vf+p7GU/Ef2Sc/mosNc2eVV7z7mKS6BywvTYzANVS65nLx/H4iEkPYHMxe9TpelkPxGDJe080NNZEG+5ikYg0AkCgQgEAhEIBCIQCEQgEIhAIBCBQCACgUAEAoEIBAIRCAQiEAhEIBCIQCAQgUAgAoFABAKBCAQCEQgEIhAIRCAQiEAgEIFAIOL/PgbINY5QihwAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
<div id="resamplergym" class="section level2">
<h2>resampleRGYM</h2>
<p>The <code>resampleRGYM</code> function resamples the mean and variance of <span class="math inline">\(R\)</span> using the same procedure implemented in the GYM. <strong>This procedure is based on a false premise and should not be used</strong>.</p>
<p>The variances simulated by this technique are often larger than it is possible for the variance of a proportion to be.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate the varianceof R</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>vs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n=</span><span class="dv">10000</span>, <span class="at">expr=</span><span class="fu">resampleRGYM</span>(<span class="at">mnR=</span><span class="fl">0.5</span>, <span class="at">vrR=</span><span class="fl">0.17</span>, <span class="at">n=</span><span class="dv">17</span>)<span class="sc">$</span>vrR)</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="do">## The simulated variance is often larger than it is possible for the</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a><span class="do">## variance of a proprtion to be</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="at">x=</span>vs, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">xlab=</span><span class="st">&quot;Variance R&quot;</span>, <span class="at">main=</span><span class="st">&quot;Resampled Variances&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="surveysurvival" class="section level2">
<h2>surveySurvival</h2>
<p>The <code>surveySurvival</code> function computes the total survival of a cohort from time of recruitment to a nominated survey period given specified natural and fishing mortalities. The resulting survivals can be used to backproject age based abundance survey data to estimate recruitment.</p>
<div id="setup-13" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Define the intra-annual natural mortality and its integral</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(<span class="at">x=</span>Ages))</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span></code></pre></div>
<p>Suppose surveys are conducted in years 3, 4 and 5, starting on time step 190 in year 1, time step 220 in year 2 and time step 150 in year 3, and in each case the survey lasted 12 days and all age classes were surveyed.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survey year,  period and age classes</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yr=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">s1=</span><span class="fu">c</span>(<span class="dv">190</span>, <span class="dv">220</span>, <span class="dv">150</span>), <span class="at">s2=</span><span class="fu">c</span>(<span class="dv">201</span>, <span class="dv">231</span>, <span class="dv">161</span>))</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">cbind</span>(svy[<span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each=</span><span class="dv">7</span>), ], <span class="at">cls=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svy)</span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>    yr  s1  s2 cls</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">1</span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="fl">1.1</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">2</span></span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">3</span></span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">4</span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a><span class="fl">1.4</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">5</span></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="fl">1.5</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">6</span></span></code></pre></div>
</div>
<div id="constant-mortality" class="section level4">
<h4>Constant mortality</h4>
<p>Assume there is no inter-annual variability in natural mortality and the annual scalings of natural mortality is constant</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant mortality</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>The total mean survival for the cohort from the start of the year in which they were in the first age class to the survey period is</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival to the survey period from age class 1</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">surveySurvival</span>(<span class="at">yr=</span>svy<span class="sc">$</span>yr, <span class="at">cls=</span>svy<span class="sc">$</span>cls, <span class="at">s1=</span>svy<span class="sc">$</span>s1, <span class="at">s2=</span>svy<span class="sc">$</span>s2, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">0.8989089</span> <span class="fl">0.7359644</span> <span class="fl">0.6025567</span> <span class="fl">0.4933317</span> <span class="fl">0.4039058</span> <span class="fl">0.3306901</span> <span class="fl">0.2707462</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">0.8842531</span> <span class="fl">0.7239652</span> <span class="fl">0.5927326</span> <span class="fl">0.4852884</span> <span class="fl">0.3973205</span> <span class="fl">0.3252985</span> <span class="fl">0.2663319</span></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="fl">0.9188285</span> <span class="fl">0.7522732</span> <span class="fl">0.6159092</span> <span class="fl">0.5042638</span> <span class="fl">0.4128563</span> <span class="fl">0.3380181</span> <span class="fl">0.2767458</span></span></code></pre></div>
<p>The computed survivals can be used to project cohort abundances the initial abundance for the first age class.</p>
<p>To compute the mean survival for the cohort from the start of the year in which they were in the third age class o the survey period</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival to the survey period from age class 3</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">surveySurvival</span>(<span class="at">yr=</span>svy<span class="sc">$</span>yr, <span class="at">cls=</span>svy<span class="sc">$</span>cls, <span class="at">s1=</span>svy<span class="sc">$</span>s1, <span class="at">s2=</span>svy<span class="sc">$</span>s2, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">3</span>)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">1.3410145</span> <span class="fl">1.0979298</span> <span class="fl">0.8989089</span> <span class="fl">0.7359644</span> <span class="fl">0.6025567</span> <span class="fl">0.4933317</span> <span class="fl">0.4039058</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">1.3191507</span> <span class="fl">1.0800292</span> <span class="fl">0.8842531</span> <span class="fl">0.7239652</span> <span class="fl">0.5927326</span> <span class="fl">0.4852884</span> <span class="fl">0.3973205</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="fl">1.3707311</span> <span class="fl">1.1222597</span> <span class="fl">0.9188285</span> <span class="fl">0.7522732</span> <span class="fl">0.6159092</span> <span class="fl">0.5042638</span> <span class="fl">0.4128563</span></span></code></pre></div>
<p>For age classes younger than third age class at the time of survey the surival is greater than 1.</p>
</div>
<div id="variable-mortality" class="section level4">
<h4>Variable mortality</h4>
<p>When there is inter-annual variability in natural mortality</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable mortality</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">rate=</span><span class="dv">100</span>)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>M</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">0.16917108</span> <span class="fl">0.20412034</span> <span class="fl">0.17200731</span> <span class="fl">0.13528569</span> <span class="fl">0.18089023</span> <span class="fl">0.26590782</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a> [<span class="dv">7</span>] <span class="fl">0.22413253</span> <span class="fl">0.15326154</span> <span class="fl">0.08766221</span> <span class="fl">0.15080240</span></span></code></pre></div>
<p>the labelling of survey years (<code>yr</code>) corresponds to the elements of <code>M</code> (so <code>yr==1</code> corresponds to <code>M[1]</code>) and survival cannot be estimated for cohorts that must be projected outside the time interval spanned by <code>M</code>.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survival cannot be projected outside the period for which mortality</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="do">## is specified.</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="fu">surveySurvival</span>(<span class="at">yr=</span>svy<span class="sc">$</span>yr, <span class="at">cls=</span>svy<span class="sc">$</span>cls, <span class="at">s1=</span>svy<span class="sc">$</span>s1, <span class="at">s2=</span>svy<span class="sc">$</span>s2, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M)</span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="fl">0.9124177</span> <span class="fl">0.7439528</span> <span class="fl">0.6281673</span>        <span class="cn">NA</span>        <span class="cn">NA</span>        <span class="cn">NA</span>        <span class="cn">NA</span></span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a> [<span class="dv">8</span>] <span class="fl">0.9201587</span> <span class="fl">0.7747488</span> <span class="fl">0.6317025</span> <span class="fl">0.5333871</span>        <span class="cn">NA</span>        <span class="cn">NA</span>        <span class="cn">NA</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">15</span>] <span class="fl">0.9262907</span> <span class="fl">0.8090838</span> <span class="fl">0.6812267</span> <span class="fl">0.5554479</span> <span class="fl">0.4690004</span>        <span class="cn">NA</span>        <span class="cn">NA</span></span></code></pre></div>
</div>
</div>
<div id="surveyadjustgym" class="section level2">
<h2>surveyAdjustGYM</h2>
<p>The <code>surveySurival</code> function adjusts surveyed age class abundances to initial abundances at a reference age class as implemented in the GYM. Where abundance is estimated from multiple surveys, abundance is estimated as a geometric mean of the estimates from individual surveys weighted by the inverse of the squared <em>coefficient of variation</em> of the surveyed density.</p>
<div id="survey-data" class="section level4">
<h4>Survey Data</h4>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make some survey data</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>survey.df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text=</span><span class="st">&quot;Survey, Year, Age, Density, SE, Scale, Start, End</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 3, 0.01, 0.01, 50340.67, 178, 179</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 4, 8.15, 8.96, 50340.67, 178, 179</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 5, 6.58, 7.13, 50340.67, 178, 179</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 6, 0.01, 0.01, 50340.67, 178, 179</span></span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="st">1, 1989, 7, 0.01, 0.01, 50340.67, 178, 179</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 3, 10.02, 8.97, 42308.13, 281, 282</span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 4, 14.12, 12.9, 42308.13, 281, 282</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 5, 0.01, 0.01, 42308.13, 281, 282</span></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 6, 15.96, 19.26, 42308.13, 281, 282</span></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="st">2, 1992, 7, 19.87, 21.84, 42308.13, 281, 282</span></span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 3, 8.72, 7.63, 81105.82, 120, 121</span></span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 4, 0.01, 0.01, 81105.82, 120, 121</span></span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 5, 73.32, 65.51, 81105.82, 120, 121</span></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 6, 94.41, 104.99, 81105.82, 120, 121</span></span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 7, 0.01, 0.01, 81105.82, 120, 121</span></span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a><span class="st">3, 1998, 8, 36.55, 31.68, 81105.82, 120, 121</span></span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 3, 7.04, 8.31, 84767.1, 175, 176</span></span>
<span id="cb254-20"><a href="#cb254-20" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 4, 12.6, 15.56, 84767.1, 175, 176</span></span>
<span id="cb254-21"><a href="#cb254-21" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 5, 30.79, 35.74, 84767.1, 175, 176</span></span>
<span id="cb254-22"><a href="#cb254-22" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 6, 56.52, 47.78, 84767.1, 175, 176</span></span>
<span id="cb254-23"><a href="#cb254-23" aria-hidden="true" tabindex="-1"></a><span class="st">4, 2000, 7, 27.55, 30.16, 84767.1, 175, 176</span></span>
<span id="cb254-24"><a href="#cb254-24" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 3, 10.51, 9.37, 86130.6, 175, 176</span></span>
<span id="cb254-25"><a href="#cb254-25" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 4, 14.51, 17.19, 86130.6, 175, 176</span></span>
<span id="cb254-26"><a href="#cb254-26" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 5, 0.01, 0.01, 86130.6, 175, 176</span></span>
<span id="cb254-27"><a href="#cb254-27" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 6, 37.78, 42.56, 86130.6, 175, 176</span></span>
<span id="cb254-28"><a href="#cb254-28" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2001, 7, 30.29, 37.05, 86130.6, 175, 176</span></span>
<span id="cb254-29"><a href="#cb254-29" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 3, 8.59, 10.36, 42865.61, 153, 154</span></span>
<span id="cb254-30"><a href="#cb254-30" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 4, 24.15, 23.4, 42865.61, 153, 154</span></span>
<span id="cb254-31"><a href="#cb254-31" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 5, 35.82, 30.15, 42865.61, 153, 154</span></span>
<span id="cb254-32"><a href="#cb254-32" aria-hidden="true" tabindex="-1"></a><span class="st">6, 2002, 6, 24.58, 21.35, 42865.61, 153, 154</span></span>
<span id="cb254-33"><a href="#cb254-33" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 3, 0.01, 0.01, 86229.58, 156, 157</span></span>
<span id="cb254-34"><a href="#cb254-34" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 4, 25.4, 28.86, 86229.58, 156, 157</span></span>
<span id="cb254-35"><a href="#cb254-35" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 5, 68.98, 66, 86229.58, 156, 157</span></span>
<span id="cb254-36"><a href="#cb254-36" aria-hidden="true" tabindex="-1"></a><span class="st">7, 2003, 6, 59.71, 74.47, 86229.58, 156, 157</span></span>
<span id="cb254-37"><a href="#cb254-37" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 3, 0.01, 0.01, 85208.41, 156, 157</span></span>
<span id="cb254-38"><a href="#cb254-38" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 4, 0.01, 0.01, 85208.41, 156, 157</span></span>
<span id="cb254-39"><a href="#cb254-39" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 5, 28.67, 29.37, 85208.41, 156, 157</span></span>
<span id="cb254-40"><a href="#cb254-40" aria-hidden="true" tabindex="-1"></a><span class="st">8, 2004, 6, 24.2, 29.24, 85208.41, 156, 157</span></span>
<span id="cb254-41"><a href="#cb254-41" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 3, 0.01, 0.01, 84305.83, 171, 172</span></span>
<span id="cb254-42"><a href="#cb254-42" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 4, 11.77, 11.17, 84305.83, 171, 172</span></span>
<span id="cb254-43"><a href="#cb254-43" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 5, 0.01, 0.01, 84305.83, 171, 172</span></span>
<span id="cb254-44"><a href="#cb254-44" aria-hidden="true" tabindex="-1"></a><span class="st">9, 2005, 6, 19.68, 18.49, 84305.83, 171, 172&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="setup-14" class="section level4">
<h4>Setup</h4>
<p>Define age classes and within year time steps</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Daily time steps and 7 age classes</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>nsteps <span class="ot">&lt;-</span> <span class="dv">365</span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>Ages <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>Days <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span><span class="dv">1</span>, <span class="at">length=</span>nsteps<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>nsteps</span></code></pre></div>
<p>Define the intra-annual natural mortality and its integral</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant intra-annual natural mortality</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">1</span>, <span class="at">nrow=</span>nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(Ages))</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> ms<span class="sc">/</span><span class="fu">mean</span>(<span class="at">x=</span><span class="fu">trapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h))</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>Ms <span class="ot">&lt;-</span> <span class="fu">ctrapz</span>(<span class="at">fs=</span>ms, <span class="at">h=</span>h)</span></code></pre></div>
<p>Suppose surveys are conducted in years 3, 4 and 5, starting on time step 190 in year 1, time step 220 in year 2 and time step 150 in year 3, and in each case the survey lasted 12 days and all age classes were surveyed.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Survey year,  period and age classes</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">yr=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">s1=</span><span class="fu">c</span>(<span class="dv">190</span>, <span class="dv">220</span>, <span class="dv">150</span>), <span class="at">s2=</span><span class="fu">c</span>(<span class="dv">201</span>, <span class="dv">231</span>, <span class="dv">161</span>))</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>svy <span class="ot">&lt;-</span> <span class="fu">cbind</span>(svy[<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each=</span><span class="dv">7</span>), ], <span class="at">cls=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svy)</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>    yr  s1  s2 cls</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">1</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="fl">1.1</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">2</span></span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">3</span></span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">4</span></span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a><span class="fl">1.4</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">5</span></span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a><span class="fl">1.5</span>  <span class="dv">3</span> <span class="dv">190</span> <span class="dv">201</span>   <span class="dv">6</span></span></code></pre></div>
</div>
<div id="constant-mortality-1" class="section level4">
<h4>Constant mortality</h4>
<p>Assume there is no inter-annual variability in natural mortality and the annual scalings of natural mortality is constant</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Constant mortality</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
<p>Convert surveyed age to the modelled age class</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert age to age class</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>AgeClass <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Age<span class="sc">-</span><span class="fu">min</span>(Ages)<span class="sc">+</span><span class="dv">1</span></span></code></pre></div>
<p>Estimate the abundance of the first age class</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust survey abundances to abundance of reference age class</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">surveyAdjustGYM</span>(<span class="at">survey.df=</span>survey.df, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">1</span>)</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>     Year       RAbund</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1984</span> <span class="dv">1984</span> <span class="fl">1.508180e+03</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1985</span> <span class="dv">1985</span> <span class="fl">1.234793e+03</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1986</span> <span class="dv">1986</span> <span class="fl">6.652137e+05</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1987</span> <span class="dv">1987</span> <span class="fl">1.340961e+06</span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1988</span> <span class="dv">1988</span> <span class="fl">1.660966e+04</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1989</span> <span class="dv">1989</span> <span class="fl">8.989819e+02</span></span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1990</span> <span class="dv">1990</span> <span class="fl">1.039266e+06</span></span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1991</span> <span class="dv">1991</span> <span class="fl">6.038108e+05</span></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1992</span> <span class="dv">1992</span> <span class="fl">1.050824e+07</span></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1993</span> <span class="dv">1993</span> <span class="fl">2.353877e+03</span></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1994</span> <span class="dv">1994</span> <span class="fl">1.819462e+07</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a><span class="dv">1995</span> <span class="dv">1995</span> <span class="fl">9.455491e+06</span></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a><span class="dv">1996</span> <span class="dv">1996</span> <span class="fl">5.501951e+05</span></span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a><span class="dv">1997</span> <span class="dv">1997</span> <span class="fl">2.644355e+06</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1998</span> <span class="dv">1998</span> <span class="fl">2.030516e+05</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1999</span> <span class="dv">1999</span> <span class="fl">2.766914e+06</span></span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span> <span class="dv">2000</span> <span class="fl">3.067984e+06</span></span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span> <span class="dv">2001</span> <span class="fl">2.743771e+06</span></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span> <span class="dv">2002</span> <span class="fl">1.388601e+03</span></span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span> <span class="dv">2003</span> <span class="fl">5.189675e+04</span></span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2004</span> <span class="dv">2004</span> <span class="fl">1.130551e+03</span></span></code></pre></div>
</div>
<div id="variable-mortality-1" class="section level4">
<h4>Variable mortality</h4>
<p>When there is inter-annual variability in natural mortality</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable mortality (22 years between 0.2 &amp; 0.201)</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">22</span>, <span class="at">min=</span><span class="fl">0.2</span>, <span class="at">max=</span><span class="fl">0.201</span>)</span></code></pre></div>
<p>The labelling of survey years (<code>Year</code>) must corresponds to the elements of <code>M</code> (so <code>Year==1</code> corresponds to <code>M[1]</code>)</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="do">## M[1] must correspond to Year==1</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>Year0 <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Year</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Year0<span class="dv">-1983</span></span></code></pre></div>
<p>Estimate the abundance of the first age class</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust survey abundances to abundance of reference age class</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>rec.df <span class="ot">&lt;-</span> <span class="fu">surveyAdjustGYM</span>(<span class="at">survey.df=</span>survey.df, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">1</span>)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>rec.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> rec.df<span class="sc">$</span>Year<span class="sc">+</span><span class="dv">1983</span></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>rec.df</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>   Year       RAbund</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1984</span> <span class="fl">1.512552e+03</span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">1985</span> <span class="fl">1.237342e+03</span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">1986</span> <span class="fl">6.664522e+05</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">1987</span> <span class="fl">1.343599e+06</span></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">1988</span> <span class="fl">1.663898e+04</span></span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">1989</span> <span class="fl">9.009113e+02</span></span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">1990</span> <span class="fl">1.040585e+06</span></span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  <span class="dv">1991</span> <span class="fl">6.040696e+05</span></span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">1992</span> <span class="fl">1.054241e+07</span></span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1993</span> <span class="fl">2.360477e+03</span></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="dv">1994</span> <span class="fl">1.823713e+07</span></span>
<span id="cb263-17"><a href="#cb263-17" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> <span class="dv">1995</span> <span class="fl">9.475033e+06</span></span>
<span id="cb263-18"><a href="#cb263-18" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="dv">1996</span> <span class="fl">5.514013e+05</span></span>
<span id="cb263-19"><a href="#cb263-19" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> <span class="dv">1997</span> <span class="fl">2.648001e+06</span></span>
<span id="cb263-20"><a href="#cb263-20" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> <span class="dv">1998</span> <span class="fl">2.033429e+05</span></span>
<span id="cb263-21"><a href="#cb263-21" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="dv">1999</span> <span class="fl">2.769360e+06</span></span>
<span id="cb263-22"><a href="#cb263-22" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="dv">2000</span> <span class="fl">3.070979e+06</span></span>
<span id="cb263-23"><a href="#cb263-23" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> <span class="dv">2001</span> <span class="fl">2.747836e+06</span></span>
<span id="cb263-24"><a href="#cb263-24" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> <span class="dv">2002</span> <span class="fl">1.389835e+03</span></span>
<span id="cb263-25"><a href="#cb263-25" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span> <span class="dv">2003</span> <span class="fl">5.193804e+04</span></span>
<span id="cb263-26"><a href="#cb263-26" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span> <span class="dv">2004</span> <span class="fl">1.131528e+03</span></span></code></pre></div>
<p>Abundance cannot be estimated for cohorts that must be projected outside the time interval spanned by <code>M</code></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>survey.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> survey.df<span class="sc">$</span>Year0<span class="dv">-1985</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjust survey abundances to abundance of reference age class</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>rec.df <span class="ot">&lt;-</span> <span class="fu">surveyAdjustGYM</span>(<span class="at">survey.df=</span>survey.df, <span class="at">Ms=</span>Ms, <span class="at">M=</span>M, <span class="at">rcls=</span><span class="dv">1</span>)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>rec.df<span class="sc">$</span>Year <span class="ot">&lt;-</span> rec.df<span class="sc">$</span>Year<span class="sc">+</span><span class="dv">1985</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>rec.df</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>   Year       RAbund</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span> <span class="dv">1984</span>           <span class="cn">NA</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1985</span>           <span class="cn">NA</span></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1986</span> <span class="fl">6.664182e+05</span></span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">1987</span> <span class="fl">1.343736e+06</span></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">1988</span> <span class="fl">1.663730e+04</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">1989</span> <span class="fl">9.009635e+02</span></span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">1990</span> <span class="fl">1.041512e+06</span></span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">1991</span> <span class="fl">6.047300e+05</span></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">1992</span> <span class="fl">1.053741e+07</span></span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  <span class="dv">1993</span> <span class="fl">2.358428e+03</span></span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">1994</span> <span class="fl">1.822824e+07</span></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">1995</span> <span class="fl">9.474426e+06</span></span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="dv">1996</span> <span class="fl">5.513199e+05</span></span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> <span class="dv">1997</span> <span class="fl">2.647857e+06</span></span>
<span id="cb264-21"><a href="#cb264-21" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="dv">1998</span> <span class="fl">2.034884e+05</span></span>
<span id="cb264-22"><a href="#cb264-22" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> <span class="dv">1999</span> <span class="fl">2.771062e+06</span></span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span> <span class="dv">2000</span> <span class="fl">3.071377e+06</span></span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span> <span class="dv">2001</span> <span class="fl">2.746305e+06</span></span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="dv">2002</span> <span class="fl">1.389809e+03</span></span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> <span class="dv">2003</span> <span class="fl">5.194824e+04</span></span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a><span class="dv">19</span> <span class="dv">2004</span> <span class="fl">1.131064e+03</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
